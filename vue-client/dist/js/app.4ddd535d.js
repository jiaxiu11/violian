(function(e){function t(t){for(var r,o,a=t[0],c=t[1],l=t[2],d=0,h=[];d<a.length;d++)o=a[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&h.push(n[o][0]),n[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);u&&u(t);while(h.length)h.shift()();return i.push.apply(i,l||[]),s()}function s(){for(var e,t=0;t<i.length;t++){for(var s=i[t],r=!0,a=1;a<s.length;a++){var c=s[a];0!==n[c]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=s[0]))}return e}var r={},n={app:0},i=[];function o(t){if(r[t])return r[t].exports;var s=r[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=r,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(s,r,function(t){return e[t]}.bind(null,r));return s},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var u=c;i.push([1,"chunk-vendors"]),s()})({0:function(e,t){},"0296":function(e,t,s){},"0313":function(e,t,s){"use strict";var r=s("0c05"),n=s.n(r);n.a},"034f":function(e,t,s){"use strict";var r=s("85ec"),n=s.n(r);n.a},"036d":function(e,t,s){"use strict";var r=s("0296"),n=s.n(r);n.a},"0a62":function(e,t,s){"use strict";var r=s("d2e0"),n=s.n(r);n.a},"0c05":function(e,t,s){},1:function(e,t,s){e.exports=s("56d7")},1867:function(e,t,s){"use strict";var r=s("de6d"),n=s.n(r);n.a},2:function(e,t){},"287e":function(e,t,s){},"2bd4":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAABlCAYAAACbUhkMAAAACXBIWXMAAAsSAAALEgHS3X78AAABCUlEQVRYhe3YPQ/BQBgH8L/GZDKxidHHKFaNmsTmy4gPIRKT2FpqFR2ZkVi8xCLBwFCLoXKXXlXf2Aye/9K7e369l/VJ2LYNEUWvyQBkvGIaqmaKGceKXksD6AGoIpghgKahalfJKekREM56j+9c0VR27DQCelOUfHeMi5wUxXKuhGwqE2r76wH75F1sPSw0CvUAnBzcG+7FAzE7zrG8rN6g9bijs+i6c8lb9BZYRhuDnxiKt7cdRpsxH5/uZ3HXcCwe4z9eJOlfYMe25m0sLssADuzMEgYjcVQIEyb895gwYcKECRMmTJgw4V9jt9nxIabkdEZYwyMuQ+bEA5sxP/DOCRt835MB8AT8017JOPCIxgAAAABJRU5ErkJggg=="},"2e05":function(e,t,s){},3:function(e,t){},"325b":function(e,t,s){e.exports=s.p+"img/violian_logo.84309c6b.png"},"359f":function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_fill__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("cb29"),core_js_modules_es_array_fill__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_fill__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_array_includes__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("caad"),core_js_modules_es_array_includes__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_array_includes__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("c975"),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("d81d"),core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("a434"),core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_object_keys__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("b64b"),core_js_modules_es_object_keys__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_object_keys__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("d3b7"),core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("ac1f"),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_es_string_includes__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("2532"),core_js_modules_es_string_includes__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es_string_includes__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("466d"),core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_9__),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("5319"),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_10__),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("1276"),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_11__),core_js_modules_web_dom_collections_iterator__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("ddb0"),core_js_modules_web_dom_collections_iterator__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(core_js_modules_web_dom_collections_iterator__WEBPACK_IMPORTED_MODULE_12__);Vex.UI={};var VF=Vex.Flow;function getRandomInt(e){return Math.floor(Math.random()*Math.floor(e))}function getStyle(e,t){var s=null,r=document.getElementById(e);return r.currentStyle?s=r.currentStyle[t]:window.getComputedStyle&&(s=document.defaultView.getComputedStyle(r,null).getPropertyValue(t)),s}function getMousePositionInCanvas(e,t){var s=getStyle(e.id,"border-left-width"),r=null!=s?s.substring(0,s.indexOf(s.match(/\D/))):0,n=getStyle(e.id,"padding-left"),i=null!=n?n.substring(0,n.indexOf(n.match(/\D/))):0,o=e.getBoundingClientRect();return{x:(t.clientX-o.left-r-i)/Vex.UI.scale,y:(t.clientY-o.top-r-i)/Vex.UI.scale}}function getAbsoluteMousePositionInCanvas(e,t){var s=getStyle(e.id,"border-left-width"),r=null!=s?s.substring(0,s.indexOf(s.match(/\D/))):0,n=getStyle(e.id,"padding-left"),i=null!=n?n.substring(0,n.indexOf(n.match(/\D/))):0,o=e.getBoundingClientRect();return{x:t.clientX-o.left-r-i,y:t.clientY-o.top-r-i}}function isCursorWithinRectangle(e,t,s,r,n,i){return n>e&&n<e+s&&i>t&&i<t+r}function getFirstTickableAfterXPosition(e,t){for(var s=null,r=0;r<e.getTickables().length;r++)if(t<e.getTickables()[r].getAbsoluteX()&&(s=e.getTickables()[r]),null!=s)break;return s}function getLastTickableBeforeXPosition(e,t){for(var s=null,r=e.getTickables().length-1;r>=0;r--)if(t>e.getTickables()[r].getAbsoluteX()&&(s=e.getTickables()[r]),null!=s)break;return s}function mergeProperties(e,t){var s={};for(var r in e)s[r]=e[r];for(var r in t)s[r]=t[r];return s}function getStemDirection(e,t){var s=e.getYForLine(2);return t<s?Vex.Flow.StaveNote.STEM_DOWN:Vex.Flow.StaveNote.STEM_UP}Vex.UI.provisoryTickableStyle={shadowBlur:0,shadowColor:"gray",fillStyle:"gray",strokeStyle:"gray"},Vex.UI.highlightNoteStyle={shadowBlur:15,shadowColor:"red",fillStyle:"black",strokeStyle:"black"},Vex.UI.defaultNoteStyle={shadowBlur:0,shadowColor:"black",fillStyle:"black",strokeStyle:"black"},Vex.UI.scale=1,Vex.UI.Handler=function(e,t,s){this.container=s||document.getElementById(e);var r={canEdit:!0,canPlay:!0,canAddStaves:!0,canChangeNoteValue:!0,showToolbar:!0,numberOfStaves:4,stavesPerRow:2,lessStaveHeight:!1,canvasProperties:{id:e+"-canvas",width:.9*window.innerWidth,tabindex:1}};this.options=mergeProperties(r,t||{}),this.canvas=this.createCanvas(),this.renderer=new Vex.Flow.Renderer(this.canvas,Vex.Flow.Renderer.Backends.CANVAS),this.ctx=this.renderer.getContext(),this.staveList=this.createStaves(),this.ctx.scale(Vex.UI.scale,Vex.UI.scale),this.currentNote=null,this.currentStave=null,this.provisoryTickable=null,this.mouseListener=new Vex.UI.MouseListener(this,this.canvas,this.staveList),this.noteMenu=new Vex.UI.NoteMenu(this,this.canvas,this.ctx),this.noteMenu.init(),this.tipRenderer=new Vex.UI.TipRenderer(this.canvas),this.tipRenderer.init()},Vex.UI.Handler.prototype.numBars=4,Vex.UI.Handler.prototype.timeSignature="4/4",Vex.UI.Handler.prototype.createCanvas=function(){for(var e=document.createElement("canvas"),t=Object.keys(this.options.canvasProperties),s=0;s<t.length;s++)e[t[s]]=this.options.canvasProperties[t[s]];return this.options.lessStaveHeight?e.height=90*Vex.UI.scale:e.height=130*Math.ceil(this.options.numberOfStaves/this.options.stavesPerRow)*Vex.UI.scale,this.container.appendChild(e),e},Vex.UI.Handler.prototype.createStaves=function(){var e=[],t=0,s=10;this.options.lessStaveHeight&&(t=-20);for(var r=(this.canvas.width/Vex.UI.scale-20)/this.options.stavesPerRow,n=0;n<this.options.numberOfStaves;n++){var i={};(n+1)%this.options.stavesPerRow==0?(i=new Vex.Flow.Stave(s,t,r),t+=130,s=10):(i=new Vex.Flow.Stave(s,t,r),s+=r),n%this.options.stavesPerRow==0&&i.addClef("treble").addTimeSignature("4/4"),i.font={family:"sans-serif",size:12,weight:""},e.push(i),i.setContext(this.ctx),i.setTickables([])}return e},Vex.UI.Handler.prototype.init=function(){return this.redraw(),this.options.canEdit&&this.mouseListener.startListening(),this},Vex.UI.Handler.prototype.resize=function(e){var t={id:this.canvas.id,width:e,height:this.canvas.height,tabindex:1};this.options.canvasProperties=t;for(var s=document.createElement("canvas"),r=Object.keys(t),n=0;n<r.length;n++)s[r[n]]=t[r[n]];this.container.removeChild(this.container.childNodes[0]),this.container.appendChild(s),this.convas=s,this.renderer=new Vex.Flow.Renderer(this.canvas,Vex.Flow.Renderer.Backends.CANVAS),this.ctx=this.renderer.getContext(),this.staveList=this.createStaves(),this.ctx.scale(Vex.UI.scale,Vex.UI.scale),this.currentNote=null,this.currentStave=null,this.provisoryTickable=null,this.mouseListener=new Vex.UI.MouseListener(this,this.canvas,this.staveList),this.noteMenu=new Vex.UI.NoteMenu(this,this.canvas,this.ctx),this.noteMenu.init(),this.tipRenderer=new Vex.UI.TipRenderer(this.canvas),this.tipRenderer.init(),this.redraw(),this.options.canEdit&&this.mouseListener.startListening()},Vex.UI.Handler.prototype.redraw=function(e){this.ctx.clear(),this.drawStaves(),e?this.drawNotes(void 0,!0):this.drawNotes()},Vex.UI.Handler.prototype.redrawStave=function(e){var t=e.getBoundingBox(),s=this.staveList.indexOf(e);(s+1)%2==0?this.ctx.clearRect(t.getX(),t.getY(),t.getW()+15,t.getH()+5):this.ctx.clearRect(t.getX()-15,t.getY(),t.getW()+16,t.getH()),this.drawStaves(e,!0),this.drawNotes(e)},Vex.UI.Handler.prototype.drawStaves=function(e){if(e)e.draw();else for(var t=0;t<this.staveList.length;t++)this.staveList[t].draw()},Vex.UI.Handler.prototype.drawNotes=function(e,t){if(void 0===e)for(var s=0;s<this.staveList.length;s++)this.drawNotes(this.staveList[s],t);else{var r=new Vex.Flow.Voice(Vex.Flow.TIME4_4).setMode(Vex.Flow.Voice.Mode.SOFT);r.setStrict(!1),r.addTickables(e.getTickables());var n=new Vex.Flow.Formatter;0!=e.getTickables().length&&(n.joinVoices([r]),n.formatToStave([r],e),r.draw(this.ctx,e),t?this.drawBeams(e,!0):this.drawBeams(e))}},Vex.UI.Handler.prototype.drawBeams=function(e,t){(t||null==e.beams)&&(e.beams=Vex.Flow.Beam.generateBeams(e.getTickables()));for(var s=0;s<e.beams.length;s++)e.beams[s].setContext(this.ctx).draw()},Vex.UI.Handler.prototype.updateProvisoryKey=function(e){if(null==this.provisoryTickable&&(this.provisoryTickable=new Vex.Flow.StaveNote({keys:["d/4"],duration:"4"})),null!=this.currentStave){if(this.provisoryTickable instanceof Vex.Flow.StaveNote&&"r"!=this.provisoryTickable.noteType){var t=NoteMap.getNoteName(this.currentStave,e);t!=this.provisoryTickable.keys[0]&&(this.provisoryTickable=this.provisoryTickable.clone({keys:[t]}),void 0!==this.provisoryTickable&&this.provisoryTickable.setStyle(Vex.UI.provisoryTickableStyle),this.provisoryTickable.setStemDirection(getStemDirection(this.currentStave,e.y)),this.provisoryTickable.setStave(this.currentStave),this.provisoryTickable.setTickContext(new Vex.Flow.TickContext))}else;this.drawProvisoryTickable(e)}},Vex.UI.Handler.prototype.updateProvisoryDuration=function(e){var t=null;this.provisoryTickable&&(t=this.provisoryTickable.x_shift),this.provisoryTickable=this.provisoryTickable.clone({duration:e}),t&&(this.provisoryTickable.x_shift=t),this.provisoryTickable.setStave(this.currentStave||this.staveList[0]),this.provisoryTickable.setTickContext(new Vex.Flow.TickContext),this.drawProvisoryTickable()},Vex.UI.Handler.prototype.updateProvisoryType=function(e){var t=null;switch(this.provisoryTickable&&(t=this.provisoryTickable.x_shift),e){case Vex.UI.TickableType.NOTE:this.provisoryTickable=new Vex.Flow.StaveNote({keys:["d/4"],duration:"4"});break;case Vex.UI.TickableType.REST:var s="4";this.provisoryTickable&&(s=this.provisoryTickable.duration),this.provisoryTickable=new Vex.Flow.StaveNote({keys:["b/4"],duration:s+"r"});break;case Vex.UI.TickableType.BAR:this.provisoryTickable=new Vex.Flow.BarNote;break;case Vex.UI.TickableType.CLEF:this.provisoryTickable=new Vex.Flow.ClefNote("treble"),this.provisoryTickable.clefKey="treble";break}this.provisoryTickable.setStave(this.currentStave||this.staveList[0]),this.provisoryTickable.setTickContext(new Vex.Flow.TickContext),void 0!==this.provisoryTickable.setStyle&&this.provisoryTickable.setStyle(Vex.UI.provisoryTickableStyle),t&&(this.provisoryTickable.x_shift=t),this.drawProvisoryTickable()},Vex.UI.Handler.prototype.drawProvisoryTickable=function(e){if(this.provisoryTickable&&null!=this.currentStave){if(this.redrawStave(this.currentStave),void 0!==e)if(this.provisoryTickable instanceof Vex.Flow.StaveNote)this.provisoryTickable.x_shift=e.x-this.provisoryTickable.getAbsoluteX()-5;else if(this.provisoryTickable instanceof Vex.Flow.BarNote){var t=new Vex.Flow.Barline(1);t.setX(e.x),t.draw(this.currentStave)}else this.provisoryTickable.getTickContext().setX(e.x-this.currentStave.getNoteStartX()-this.provisoryTickable.render_options.stave_padding);if(null==this.currentNote){var s=this.ctx.fillStyle,r=this.ctx.strokeStyle;this.ctx.fillStyle="gray",this.ctx.strokeStyle="gray",this.provisoryTickable instanceof Vex.Flow.BarNote||this.provisoryTickable.draw(),this.ctx.fillStyle=s,this.ctx.strokeStyle=r}}},Vex.UI.Handler.prototype.openMenuForKey=function(e,t){this.mouseListener.stopListening(),this.noteMenu.setNote(this.currentNote),this.noteMenu.setKeyIndex(this.currentNote.indexOfKey(e)),this.noteMenu.open(t)},Vex.UI.Handler.prototype.noteMenuClosed=function(){this.redraw(),this.mouseListener.startListening()},Vex.UI.Handler.prototype.addAccidentalToNote=function(e,t,s){void 0!==s&&-1!=s||(s=0);var r=new Vex.Flow.Accidental(e);t.addAccidental(s,r)},Vex.UI.Handler.prototype.addDotToNote=function(e){0==e.dots&&e.addDotToAll()},Vex.UI.Handler.prototype.beamWithNextNote=function(e){var t=this.currentStave.getNextNote(e);if(null!=t){notes=[e,t],t.setStemDirection(e.getStemDirection());var s=new Vex.Flow.Beam(notes);this.currentStave.pushBeam(s)}},Vex.UI.Handler.prototype.deleteNote=function(e){for(var t=0;t<this.staveList.length;t++){var s=this.staveList[t].getNotes(),r=s.indexOf(e);r>-1&&this.staveList[t].removeTickable(e)}},Vex.UI.Handler.prototype.exportNotes=function(){for(var e=[],t=0;t<this.staveList.length;t++)for(var s=0;s<this.staveList[t].getTickables().length;s++){var r=this.staveList[t].getTickables()[s];if(r instanceof Vex.Flow.StaveNote){var n=r.duration,i=r.keys[0],o=r.dots,a=r.noteType,c=i+"/"+n;"r"==a&&(c+="r"),1==o&&(c+="d"),e.push(c)}}return e},Vex.UI.Handler.prototype.importNotes=function(notes,timeSignature){if(notes&&timeSignature){for(var tickables=[],barNum=0,barDuration=eval(timeSignature),accumDuration=0,j=0;j<this.staveList.length;j++)this.staveList[j].setTickables([]);for(var i=0;i<notes.length&&barNum<this.staveList.length;i++){var noteArr=notes[i].split("/"),dur=noteArr[2],isDot=!1,isRest=!1;dur.includes("r")&&(dur=dur.replace("r",""),isRest=!0),dur.includes("d")&&(dur=dur.replace("d",""),isDot=!0);var staveNote=new Vex.Flow.StaveNote({clef:"treble",keys:[noteArr[0]+"/"+noteArr[1]],duration:isRest?dur+"r":dur});staveNote.autoStem(),staveNote.setStyle(Vex.UI.defaultNoteStyle),staveNote.setTickContext(new Vex.Flow.TickContext),dur=1/parseInt(dur),isDot&&(dur*=1.5,staveNote.addDotToAll()),accumDuration+dur>barDuration?(this.staveList[barNum].setTickables(tickables),tickables=[],barNum++,accumDuration=dur):accumDuration+=dur,barNum<this.staveList.length&&staveNote.setStave(this.staveList[barNum]),tickables.push(staveNote)}tickables.length>0&&barNum+1<=this.options.numberOfStaves&&this.staveList[barNum].setTickables(tickables);for(var j=0;j<this.staveList.length;j++)this.drawBeams(this.staveList[j],!0);this.redraw()}},Vex.UI.Handler.prototype.changeBars=function(e){if(e>this.numBars){for(var t=this.numBars;t<e;t++)this.staveList[t].setTickables([]),this.staveList[t].usable=!0;this.redraw()}else if(e<this.numBars){for(var s=[],r=this.timeSignature.split("/")[1]+"r",n=0;n<parseInt(this.timeSignature.split("/")[0]);n++)s.push(new Vex.Flow.StaveNote({clef:"treble",keys:["b/4"],duration:r}));for(t=e;t<this.staveList.length;t++)this.staveList[t].setTickables(s),this.staveList[t].usable=!1;this.redraw()}this.numBars=e},Vex.UI.Handler.prototype.setTimeSignature=function(e){for(var t=0;t<this.staveList.length;t++)(t+1)%2==1&&this.staveList[t].setTimeSignature(e);this.timeSignature=e,this.redraw()},Vex.UI.Handler.prototype.highlightNote=function(e){if(0==e)this.staveList[0].getTickables()[0].setHighlight(!0),this.redraw();else{var t=0,s=this.staveList[t].getTickables().length;while(e>s)e-=s,t++,s=this.staveList[t].getTickables().length;s>e&&this.staveList[t].getTickables()[e].setHighlight(!0),this.redraw()}},Vex.UI.Handler.prototype.changeNumberOfBars=function(e,t){this.container.removeChild(this.container.lastElementChild);var s={numberOfStaves:e};this.options=mergeProperties(this.options,s||{}),this.canvas=this.createCanvas(),this.renderer=new Vex.Flow.Renderer(this.canvas,Vex.Flow.Renderer.Backends.CANVAS),this.ctx=this.renderer.getContext(),this.staveList=this.createStaves(),this.ctx.scale(Vex.UI.scale,Vex.UI.scale),this.currentNote=null,this.currentStave=null,this.provisoryTickable=null,this.mouseListener=new Vex.UI.MouseListener(this,this.canvas,this.staveList),this.noteMenu=new Vex.UI.NoteMenu(this,this.canvas,this.ctx),this.noteMenu.init(),this.tipRenderer=new Vex.UI.TipRenderer(this.canvas),this.tipRenderer.init(),this.init(),this.importNotes(t,this.timeSignature)},Vex.UI.NoteMenu=function(e,t,s){this.handler=e,this.canvas=t,this.ctx=s,this.note=null,this.keyIndex=null,this.panelProps=null,this.buttons=[],this.accidentals=["doubleFlat","flat","natural","sharp","doubleSharp"],this.canRender=!1,this.currentButton=null,this.buttonRenderer=new Vex.UI.NoteMenuButtonRenderer},Vex.UI.NoteMenu.prototype.init=function(){},Vex.UI.NoteMenu.prototype.setTipArea=function(){var e=5,t=5,s=5,r=10,n=this.panelProps.x+e,i=this.panelProps.bottomY-s-r,o=this.panelProps.width-e-t,a=r-s;this.handler.tipRenderer.boundingBox={x:n,y:i,width:o,height:a},this.handler.tipRenderer.backgroundColor=this.panelProps.backgroundColor},Vex.UI.NoteMenu.prototype.open=function(e){this.panelProps=this.drawMenuPanel(e),this.buttonRenderer.panel=this.panelProps,this.buttonRenderer.context=this.ctx,this.buttonRenderer.ready&&(this.drawButtons(),this.canvas.addEventListener("mouseup",this,!1),this.canvas.addEventListener("mousemove",this,!1),this.canvas.addEventListener("contextmenu",this,!1),this.setTipArea())},Vex.UI.NoteMenu.prototype.close=function(){this.buttons=[],this.currentButton=null,this.canvas.removeEventListener("mouseup",this,!1),this.canvas.removeEventListener("mousemove",this,!1),this.canvas.removeEventListener("contextmenu",this,!1),this.handler.noteMenuClosed()},Vex.UI.NoteMenu.prototype.handleEvent=function(e){switch(e.preventDefault(),e.type){case"mouseup":this.handleMouseClick(e);break;case"mousemove":this.handleMouseMove(e);break}},Vex.UI.NoteMenu.prototype.setNote=function(e){this.note=e},Vex.UI.NoteMenu.prototype.setKeyIndex=function(e){this.keyIndex=e},Vex.UI.NoteMenu.prototype.drawMenuPanel=function(e){var t=this.canvas,s=200,r=100,n=e.x+30,i=e.y,o="right";(n+s)*Vex.UI.scale>t.width&&(n=e.x-s-30,o="left"),(i+r)*Vex.UI.scale>t.height&&(i=t.height/Vex.UI.scale-r-10);var a=this.ctx;return a.beginPath(),a.rect(n,i,s,r),a.fillStyle="#ddc",a.fill(),a.lineWidth=3,a.strokeStyle="black",a.stroke(),a.beginPath(),a.moveTo(e.x,e.y),"right"==o?a.lineTo(n,i):a.lineTo(n+s,i),a.stroke(),{width:s,height:r,x:n,y:i,rightX:n+s,bottomY:i+r,backgroundColor:"#ddc",position:o}},Vex.UI.NoteMenu.prototype.drawButtons=function(){this.buttons.push(this.buttonRenderer.closeButton());for(var e=0;e<this.accidentals.length;e++)this.buttons.push(this.buttonRenderer.accidentalButton(e));this.buttons.push(this.buttonRenderer.dotButton()),this.buttons.push(this.buttonRenderer.beamButton()),this.buttons.push(this.buttonRenderer.deleteButton())},Vex.UI.NoteMenu.prototype.handleMouseClick=function(e){if(0==e.button)for(var t=getMousePositionInCanvas(this.canvas,e),s=0;s<this.buttons.length;s++){var r=this.buttons[s];if(isCursorWithinRectangle(r.props.x,r.props.y,r.props.width,r.props.height,t.x,t.y)){r.callAction(this);break}}},Vex.UI.NoteMenu.prototype.handleMouseMove=function(e){for(var t=getMousePositionInCanvas(this.canvas,e),s=0;s<this.buttons.length;s++){var r=this.buttons[s];if(isCursorWithinRectangle(r.props.x,r.props.y,r.props.width,r.props.height,t.x,t.y)){null!=this.currentButton&&this.currentButton==r||(null!=this.currentButton&&this.currentButton.highlight(this.canvas,null,this.currentButton),this.currentButton=r,this.currentButton.highlight(this.canvas,"yellow",this.currentButton),this.handler.tipRenderer.showTip(this.currentButton.props.tip));break}r.highlight(this.canvas,null,r)}},Vex.UI.NoteMenu.prototype.addDoubleFlat=function(){this.handler.addAccidentalToNote("bb",this.note,this.keyIndex),this.close()},Vex.UI.NoteMenu.prototype.addFlat=function(){this.handler.addAccidentalToNote("b",this.note,this.keyIndex),this.close()},Vex.UI.NoteMenu.prototype.addNatural=function(){this.handler.addAccidentalToNote("n",this.note,this.keyIndex),this.close()},Vex.UI.NoteMenu.prototype.addSharp=function(){this.handler.addAccidentalToNote("#",this.note,this.keyIndex),this.close()},Vex.UI.NoteMenu.prototype.addDoubleSharp=function(){this.handler.addAccidentalToNote("##",this.note,this.keyIndex),this.close()},Vex.UI.NoteMenu.prototype.addDot=function(){this.handler.addDotToNote(this.note),this.close()},Vex.UI.NoteMenu.prototype.addBeam=function(){this.handler.beamWithNextNote(this.note),this.close()},Vex.UI.NoteMenu.prototype.deleteNote=function(){this.handler.deleteNote(this.note),this.close()},Vex.UI.MouseListener=function(e,t,s){this.handler=e,this.canvas=t,this.staveList=s},Vex.UI.MouseListener.prototype.handleEvent=function(e){switch(e.preventDefault(),e.type){case"mouseup":this.handleMouseClick(e);break;case"mousemove":this.handleMouseOver(e);break;case"wheel":this.handleMouseWheel(e);break;case"contextmenu":this.handleRightMouseClick(e);break;case"mouseleave":this.handleMouseLeave(e);break}},Vex.UI.MouseListener.prototype.startListening=function(){this.canvas.addEventListener("mouseup",this,!1),this.canvas.addEventListener("mousemove",this,!1),this.canvas.addEventListener("wheel",this,!1),this.canvas.addEventListener("contextmenu",this,!1),this.canvas.addEventListener("mouseleave",this,!1)},Vex.UI.MouseListener.prototype.stopListening=function(){this.canvas.removeEventListener("mouseup",this,!1),this.canvas.removeEventListener("mousemove",this,!1),this.canvas.removeEventListener("wheel",this,!1),this.canvas.removeEventListener("contextmenu",this,!1),this.canvas.removeEventListener("mouseleave",this,!1)},Vex.UI.MouseListener.prototype.handleMouseLeave=function(e){this.handler.redraw()},Vex.UI.MouseListener.prototype.handleMouseOver=function(e){var t=getMousePositionInCanvas(this.canvas,e),s=r(this.staveList,t);function r(e,t){for(var s=0;s<e.length;s++){var r=e[s].getBoundingBox();if(isCursorWithinRectangle(r.getX(),r.getY(),r.getW(),r.getH(),t.x,t.y)&&e[s].usable)return e[s]}return null}function n(e,t){var s=[];null!=e&&(s=e.getTickables());for(var r=0;r<s.length;r++)if(s[r]instanceof Vex.Flow.StaveNote){void 0!==s[r].setHighlight&&s[r].setHighlight(!1);var n=s[r].getBoundingBox(),i=e.getBoundingBox();if(isCursorWithinRectangle(n.getX(),i.getY(),n.getW(),i.getH(),t.x,t.y))return s[r]}return null}s&&this.handler.currentStave&&s!=this.handler.currentStave&&this.handler.redraw(),this.handler.currentStave=s,this.handler.currentNote=n(this.handler.currentStave,t),this.handler.updateProvisoryKey(t),null!=this.handler.currentNote&&(this.handler.currentNote.setHighlight(!0),this.handler.redraw())},Vex.UI.MouseListener.prototype.handleMouseClick=function(e){switch(e.button){case 0:this.handleLeftMouseClick(e);break;case 1:this.handleMiddleMouseClick(e);break;case 2:break;default:alert("You have a strange Mouse!")}},Vex.UI.MouseListener.prototype.handleMouseWheel=function(e){var t=Math.max(-1,Math.min(1,e.wheelDelta||e.deltaY));if(null!=this.handler.currentNote){var s=this.handler.currentNote.duration,r=void 0!==Vex.Flow.durationAliases[s];r&&(s=Vex.Flow.durationAliases[s]),t>0?s*=2:s/=2,s<1&&(s=1),s=""+s;var n=this.handler.currentNote.clone({duration:s});this.handler.currentStave.replaceTickable(this.handler.currentNote,n),this.handler.currentNote=n,this.handler.currentNote.setHighlight(!0),this.handler.redraw()}else if(null!=this.handler.provisoryTickable)if(this.handler.provisoryTickable instanceof Vex.Flow.StaveNote){s=this.handler.provisoryTickable.duration,r=void 0!==Vex.Flow.durationAliases[s];r&&(s=Vex.Flow.durationAliases[s]),t>0?s*=2:s/=2,s<1&&(s=1),s=""+s,this.handler.updateProvisoryDuration(s)}else if(this.handler.provisoryTickable instanceof Vex.Flow.BarNote){var i=(this.handler.provisoryTickable.type+5+t)%6+1;this.handler.provisoryTickable.setType(i),this.handler.drawProvisoryTickable()}else if(this.handler.provisoryTickable instanceof Vex.Flow.ClefNote){switch(this.handler.provisoryTickable.clefKey){case"treble":this.handler.provisoryTickable.clefKey="bass",this.handler.provisoryTickable.setClef("bass");break;case"bass":this.handler.provisoryTickable.clefKey="treble",this.handler.provisoryTickable.setClef("treble")}this.handler.drawProvisoryTickable()}},Vex.UI.MouseListener.prototype.handleLeftMouseClick=function(e){if(null!=this.handler.currentStave&&this.handler.currentStave.usable){var t=getMousePositionInCanvas(this.canvas,e);if(null==this.handler.currentNote){var s=getLastTickableBeforeXPosition(this.handler.currentStave,t.x),r=getFirstTickableAfterXPosition(this.handler.currentStave,t.x),n=this.handler.provisoryTickable.clone();this.handler.currentStave.insertTickableBetween(n,s,r),this.handler.redraw(!0)}else{var i=NoteMap.getNoteName(this.handler.currentStave,t),o=this.handler.currentNote.indexOfKey(i);if(-1==o){var a=this.handler.currentNote.keys;a.push(i);var c=this.handler.currentNote;n=c.clone({keys:a});this.handler.currentStave.replaceTickable(c,n),this.handler.currentNote=n,this.handler.redraw()}}}},Vex.UI.MouseListener.prototype.handleMiddleMouseClick=function(e){var t=this.handler.provisoryTickable,s=null;t instanceof Vex.Flow.StaveNote?s="n"==t.noteType?Vex.UI.TickableType.REST:Vex.UI.TickableType.BAR:t instanceof Vex.Flow.BarNote&&(s=Vex.UI.TickableType.NOTE),this.handler.updateProvisoryType(s)},Vex.UI.MouseListener.prototype.handleRightMouseClick=function(e){if(null!=this.handler.currentStave&&null!=this.handler.currentNote){var t=getMousePositionInCanvas(this.canvas,e),s=NoteMap.getNoteName(this.handler.currentStave,t);this.handler.openMenuForKey(s,t)}},Vex.Flow.Stave.prototype.tickables=[],Vex.Flow.Stave.prototype.beams=[],Vex.Flow.Stave.prototype.usable=!0,Vex.Flow.Stave.prototype.setTickables=function(e){this.tickables=e},Vex.Flow.Stave.prototype.getTickables=function(){return this.tickables},Vex.Flow.Stave.prototype.getNotes=function(){for(var e=[],t=0;t<this.tickables.length;t++){var s=this.tickables[t];s instanceof Vex.Flow.StaveNote&&e.push(s)}return e},Vex.Flow.Stave.prototype.insertTickableBetween=function(e,t,s){if(e instanceof Vex.Flow.ClefNote){if(this.getClefModifierIndex()<0)return void this.addClef(e.clefKey);if(null==t)return void this.replaceClef(e.clefKey);if(0==this.getNotes().length)return}else if(e instanceof Vex.Flow.BarNote){if(null==s)return void this.setEndBarType(e.type);if(0==this.getNotes().length)return}if(null==s)this.pushTickable(e);else{var r=this.tickables.indexOf(s);this.tickables.splice(r,0,e)}},Vex.Flow.Stave.prototype.getClefModifierIndex=function(){for(var e=0;e<this.modifiers.length;e++){var t=this.modifiers[e];if(t instanceof Vex.Flow.Clef)return e}return-1},Vex.Flow.Stave.prototype.replaceClef=function(e){var t=this.start_x;this.clef=e;new Vex.Flow.Clef(e);this.modifiers.splice(this.getClefModifierIndex(),1),this.glyphs=[],this.addClef(e),this.start_x=t},Vex.Flow.Stave.prototype.getPreviousTickable=function(e){var t=this.tickables.indexOf(e);return 0==t?null:this.tickables[t-1]},Vex.Flow.Stave.prototype.getNextTickable=function(e){var t=this.tickables.indexOf(e);return t==this.tickables.length-1?null:this.tickables[t+1]},Vex.Flow.Stave.prototype.getNextNote=function(e){var t=this.tickables.indexOf(e);while(t<this.tickables.length)if(t++,this.tickables[t]instanceof Vex.Flow.StaveNote)return this.tickables[t];return null},Vex.Flow.Stave.prototype.replaceTickable=function(e,t){if(null!=e.beam){var s=e.beam,r=s.tickables.indexOf(e);s.notes[r]=t}r=this.tickables.indexOf(e);this.tickables[r]=t},Vex.Flow.Stave.prototype.removeTickable=function(e){this.tickables.splice(this.tickables.indexOf(e),1)},Vex.Flow.Stave.prototype.pushTickable=function(e){this.tickables.push(e)},Vex.Flow.Stave.prototype.beams=[],Vex.Flow.Stave.prototype.setBeams=function(e){this.beams=e},Vex.Flow.Stave.prototype.getBeams=function(){return this.beams},Vex.Flow.Stave.prototype.pushBeam=function(e){this.beams.push(e)},Vex.Flow.StaveNote.prototype.indexOfKey=function(e){return this.keys.indexOf(e)},Vex.Flow.StaveNote.prototype.letter="R",Vex.Flow.StaveNote.prototype.getPlayEvents=function(e){for(var t=[],s=0;s<this.keys.length;s++)t.push(MIDI.keyToNote[this.keys[s].replace("/","")]);for(s=0;s<t.length;s++)t[s]+=Vex.UI.ClefOffsets[e.clef];var r=e.defaultTime/this.duration;for(s=0;s<this.modifiers.length;s++){var n=this.modifiers[s];if(n instanceof Vex.Flow.Accidental){var i;switch(n.type){case"bb":i=-2;break;case"b":i=-1;break;case"n":i=0;break;case"#":i=1;break;case"##":i=2;break}t[n.index]+=i}else n instanceof Vex.Flow.Dot&&(r*=1.5)}var o=[];return o.push({type:"channel",channel:0,subtype:1==t.length?"noteOn":"chordOn",noteNumber:1==t.length?t[0]:t,velocity:127,queuedTime:e.delay,note:this}),o.push({type:"channel",channel:0,subtype:1==t.length?"noteOff":"chordOff",noteNumber:1==t.length?t[0]:t,queuedTime:e.delay+r,note:this}),e.delay=e.delay+r,o},Vex.Flow.StaveNote.prototype.clone=function(e){var t={keys:this.keys,stem_direction:this.getStemDirection(),duration:this.duration,noteType:this.noteType},s=mergeProperties(t,e);s.duration=s.duration+s.noteType;var r=new Vex.Flow.StaveNote(s);r.setStyle(this.note_heads[0].style),null!=this.modifierContext&&null!=this.getDots()&&r.addDotToAll(),r.beam=this.beam;for(var n=0;n<this.modifiers.length;n++)this.modifiers[0]instanceof Vex.Flow.Accidental&&r.addAccidental(this.modifiers[n].index,new Vex.Flow.Accidental(this.modifiers[n].type));return r},Vex.Flow.StaveNote.prototype.setHighlight=function(e){e?this.setStyle(Vex.UI.highlightNoteStyle):this.setStyle(Vex.UI.defaultNoteStyle)},Vex.Flow.StaveNote.prototype.change=function(e){var t=new Array;for(var s in this.keys){var r=this.keys[s].split("/");r[0]=r[0].toUpperCase();var n=r[0].substring(0,1),i=r[0].substring(1),o=parseInt(r[1]),a=0;for(var c in NoteMap.noteMap)if(NoteMap.noteMap[c]==n){a=c;break}if("UP"==e)a++;else if("DOWN"==e)a--;else if("SHARP"==e){switch(i){case"":case null:case void 0:i="#";break;case"#":i="##";break}alert(i)}a==NoteMap.noteMap.length?(a=0,o++):a<0&&(a=NoteMap.noteMap.length-1,o--),n=NoteMap.noteMap[a],t.push(n+i+"/"+o)}var l=this.duration,u=this.noteType;if("PAUSE"==e){"n"==u?u="r":"r"==u&&(u="n"),l=Vex.Flow.parseNoteDurationString(this.duration);for(var d="",h=0;h<l.dots;h++)d+="d";l=l.duration+d+u}return this.clone({keys:t,duration:l})},Vex.Flow.StaveNote.prototype.drawFlag=function(){if(!this.context)throw new Vex.RERR("NoCanvasContext","Can't draw without a canvas context.");var e=this.context,t=this.getGlyph(),s=null===this.beam,r=this.getNoteHeadBounds(),n=this.getNoteHeadBeginX(),i=this.getNoteHeadEndX();if(t.flag&&s){var o,a,c=this.stem.getHeight();this.getStemDirection()===Vex.Flow.Stem.DOWN?(o=n,a=r.y_top-c,t.code_flag_downstem):(o=i,a=r.y_bottom-c,t.code_flag_upstem);var l=e.fillStyle;e.fillStyle=this.note_heads[0].style.fillStyle,e.openGroup("flag",null,{pointerBBox:!0}),this.applyStyle(e,this.getFlagStyle()||!1),this.flag.render(e,o,a),this.restoreStyle(e,this.getFlagStyle()||!1),e.closeGroup(),e.fillStyle=l}},Vex.Flow.Dot.prototype.draw=function(){if(!this.context)throw new Vex.RERR("NoContext","Can't draw dot without a context.");if(!this.note||null==this.index)throw new Vex.RERR("NoAttachedNote","Can't draw dot without a note and index.");this.note.stave.options.spacing_between_lines_px;var e=this.note.getModifierStartXY(this.position,this.index);"tabnotes"===this.note.getCategory()&&(e.y=this.note.getStemExtents().baseY);var t=e.x+this.x_shift+this.width-this.radius,s=e.y+this.y_shift,r=this.context;r.beginPath(),r.arc(t,s,this.radius,0,2*Math.PI,!1),r.fill()},Vex.Flow.BarNote.prototype.clone=function(){var e=new Vex.Flow.BarNote;return e.setType(this.getType()),e.setStave(this.getStave()),e.setTickContext(this.getTickContext()),e},Vex.Flow.BarNote.prototype.getPlayEvents=function(e,t){var s=[];function r(){e.beginRepeatIndex=t.length+s.length}function n(){for(var r=e.beginRepeatIndex||0;r<t.length;r++)s.push(t[r])}switch(this.type){case Vex.Flow.Barline.type.REPEAT_BEGIN:r();break;case Vex.Flow.Barline.type.REPEAT_END:n();break;case Vex.Flow.Barline.type.REPEAT_BOTH:n(),r();break}return s},Vex.Flow.ClefNote.prototype.clone=function(){var e=new Vex.Flow.ClefNote(this.clefKey);return e.clefKey=this.clefKey,e.setTickContext(new Vex.Flow.TickContext),e.getTickContext().setX(this.getTickContext().getX()),e},Vex.Flow.ClefNote.prototype.getPlayEvents=function(e){return e.clef=this.clefKey,[]},Vex.UI.NoteMap=function(){this.noteMap=["C","D","E","F","G","A","B"]},Vex.UI.NoteMap.prototype.getNoteName=function(e,t){var s=t.y-e.getBoundingBox().getY(),r=Math.round(s/(e.options.spacing_between_lines_px/2));return this.toNoteName(r,e)},Vex.UI.NoteMap.prototype.toNoteName=function(e,t){var s=this.getBaseNote(t),r=this.noteMap.indexOf(s.note),n=(r-e)%7;while(n<0)n+=7;var i=s.octave-Math.floor(e/7);return 5!=n&&6!=n||i--,this.noteMap[n]+"/"+i},Vex.UI.NoteMap.prototype.getBaseNote=function(e){return{note:"G",octave:6}};var NoteMap=new Vex.UI.NoteMap;Vex.UI.TipRenderer=function(e){this.canvas=e,this.color=null,this.fontSize=null,this.fontName=null,this.style=null,this.context=null,this.lineWidth=null,this.textAlign=null,this.textBaseline=null,this.boundingBox=null,this.showingTip=null,this.backgroundColor=null},Vex.UI.TipRenderer.prototype.init=function(){this.textAlign="left",this.textBaseline="middle",this.color="black",this.fontName="Calibri",this.lineWidth=1,this.style="normal",this.fontSize=10,this.boundingBox={x:0,y:0,width:200,height:20},this.context=this.canvas.getContext("2d"),this.showingTip=!1,this.backgroundColor="white"},Vex.UI.TipRenderer.prototype.showTip=function(e){this.showingTip&&this.hideTip();var t=this.style+" "+this.fontSize+"pt "+this.fontName;this.context.font=t,this.context.fillStyle=this.color,this.context.textAlign=this.textAlign,this.context.lineWidth=this.lineWidth,this.context.textBaseline=this.textBaseline,this.context.fillText(e,this.boundingBox.x,this.boundingBox.y),this.showingTip=!0},Vex.UI.TipRenderer.prototype.hideTip=function(){this.context.beginPath(),this.context.rect(this.boundingBox.x,this.boundingBox.y-5,this.boundingBox.width,this.boundingBox.height+10),this.context.fillStyle=this.backgroundColor,this.context.fill(),this.showingTip=!1},Vex.UI.NoteMenuButtonRenderer=function(e,t){this.ready=!1;var s=this;this.menuButtonsImg=new Image,this.menuButtonsImg.src="https://cdn.jsdelivr.net/gh/R-D-D-D/Ground-Zero/web_frontend/src/resources/noteMenuButtons.gif",this.menuButtonsImg.onload=function(){s.ready=!0}},Vex.UI.NoteMenuButtonRenderer.prototype.closeButton=function(){var e=this.panel,t=this.context,s=5,r=4,n=15,i=e.rightX-n-s,o=e.y+s;return t.beginPath(),t.rect(i,o,n,n),t.fillStyle="red",t.fill(),t.beginPath(),t.lineWidth=3,t.moveTo(i+r,o+r),t.lineTo(i+n-r,o+n-r),t.moveTo(i+r,o+n-r),t.lineTo(i+n-r,o+r),t.strokeStyle="white",t.stroke(),new Vex.UI.Button({backgroundColor:"red",width:n,height:n,x:i,y:o,rightX:i+n,bottomY:o+n,name:"closeButton",action:"close",tip:"Close the menu"})},Vex.UI.NoteMenuButtonRenderer.prototype.closeButton=function(){var e=this.panel,t=this.context,s=5,r=4,n=15,i=e.rightX-n-s,o=e.y+s;return t.beginPath(),t.rect(i,o,n,n),t.fillStyle="red",t.fill(),t.beginPath(),t.lineWidth=3,t.moveTo(i+r,o+r),t.lineTo(i+n-r,o+n-r),t.moveTo(i+r,o+n-r),t.lineTo(i+n-r,o+r),t.strokeStyle="white",t.stroke(),new Vex.UI.Button({backgroundColor:"red",width:n,height:n,x:i,y:o,rightX:i+n,bottomY:o+n,name:"closeButton",action:"close",tip:"Close the menu"})},Vex.UI.NoteMenuButtonRenderer.prototype.accidentalButton=function(e){var t=this.panel,s=this.context,r=this.menuButtonsImg,n=[400,100,200,0,300],i=["addDoubleFlat","addFlat","addNatural","addSharp","addDoubleSharp"],o=["Add double flat to key","Add flat to key","Add natural to key","Add sharp to key","Add double sharp to key"],a=10,c=5,l=10,u=n[e],d=0,h=100,p=100,m=25,v=m,f=t.x+a+e*(c+m),g=t.y+l;return s.drawImage(r,u,d,h,p,f,g,m,v),new Vex.UI.Button({backgroundColor:"white",x:f,y:g,rightX:f+m,bottomY:g+v,width:m,height:v,action:i[e],tip:o[e]})},Vex.UI.NoteMenuButtonRenderer.prototype.dotButton=function(){var e=this.panel,t=this.context,s=this.menuButtonsImg,r=700,n=10,i=10,o=r,a=0,c=100,l=100,u=25,d=u,h=e.x+n,p=e.y+2*i+d;return t.drawImage(s,o,a,c,l,h,p,u,d),new Vex.UI.Button({backgroundColor:"white",x:h,y:p,rightX:h+u,bottomY:p+d,width:u,height:d,action:"addDot",tip:"Add dot to key"})},Vex.UI.NoteMenuButtonRenderer.prototype.beamButton=function(){var e=this.panel,t=this.context,s=this.menuButtonsImg,r=500,n=10,i=5,o=10,a=r,c=0,l=100,u=100,d=25,h=d,p=e.x+n+(i+d),m=e.y+2*o+h;return t.drawImage(s,a,c,l,u,p,m,d,h),new Vex.UI.Button({backgroundColor:"white",x:p,y:m,rightX:p+d,bottomY:m+h,width:d,height:h,action:"addBeam",tip:"Beam with next note"})},Vex.UI.NoteMenuButtonRenderer.prototype.deleteButton=function(){var e=this.panel,t=this.context,s=this.menuButtonsImg,r=800,n=10,i=5,o=10,a=r,c=0,l=100,u=100,d=25,h=d,p=e.x+n+3*(i+d),m=e.y+2*o+h;return t.drawImage(s,a,c,l,u,p,m,d,h),new Vex.UI.Button({backgroundColor:"white",x:p,y:m,rightX:p+d,bottomY:m+h,width:d,height:h,action:"deleteNote",tip:"Remove key"})},Vex.UI.NoteMenuButtonRenderer.prototype.tieButton=function(){var e=this.panel,t=this.context,s=this.menuButtonsImg,r=600,n=10,i=5,o=10,a=r,c=0,l=100,u=100,d=25,h=d,p=e.x+n+2*(i+d),m=e.y+2*o+h;return t.drawImage(s,a,c,l,u,p,m,d,h),new Vex.UI.Button({backgroundColor:"white",x:p,y:m,rightX:p+d,bottomY:m+h,width:d,height:h,action:"addTie",tip:"Tie with next note"})},Vex.UI.Button=function(e){this.props=e},Vex.UI.Button.prototype.highlight=function(e,t,s){null==t&&(t=s.props.backgroundColor);var r=4,n=e.getContext("2d");n.beginPath(),n.lineWidth=r,n.rect(s.props.x,s.props.y,s.props.width,s.props.height),n.strokeStyle=t,n.stroke()},Vex.UI.Button.prototype.showTip=function(){},Vex.UI.Button.prototype.callAction=function(e){e[this.props.action]()},Vex.UI.TickableType={NOTE:"note",REST:"rest",BAR:"bar",CLEF:"clef"},Vex.UI.Handler.prototype.getNotePositions=function(){var e=this.staveList;return e.map((function(e){return e.getTickables().map((function(e){return e.getBoundingBox()}))}))},Vex.UI.notesToBars=function(notes,timeSignature){if(notes&&timeSignature){for(var tickables=[],barNum=0,barDuration=eval(timeSignature),accumDuration=0,notesInBars=[],i=0;i<notes.length;i++){var noteArr=notes[i].split("/"),dur=noteArr[2],isDot=!1;dur.includes("r")&&(dur=dur.replace("r","")),dur.includes("d")&&(dur=dur.replace("d",""),isDot=!0),dur=1/parseInt(dur),isDot&&(dur*=1.5),accumDuration+=dur,tickables.push(notes[i]),accumDuration==barDuration&&(notesInBars.push(tickables),tickables=[],barNum++,accumDuration=0)}return tickables.length>0&&barNum+1<this.options.numberOfStaves&&notesInBars.push(tickables),notesInBars}},__webpack_exports__["a"]=Vex.UI},3730:function(e,t,s){"use strict";var r=s("d0d9"),n=s.n(r);n.a},4:function(e,t){},"46a2":function(e,t,s){"use strict";var r=s("5718"),n=s.n(r);n.a},4799:function(e,t,s){},"4a21":function(e,t,s){"use strict";var r=s("7812"),n=s.n(r);n.a},"4cf2":function(e,t,s){},"56d7":function(e,t,s){"use strict";s.r(t);s("e260"),s("e6cf"),s("cca6"),s("a79d");var r=s("2b0e"),n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-app",{attrs:{id:"app"}},[s("page-header"),s("v-main",[s("router-view")],1)],1)},i=[],o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("v-app-bar",{attrs:{light:"",app:"",absolute:"",color:"white"}},[r("router-link",{staticClass:"pl-3",attrs:{id:"logo",to:"/"}},[r("img",{attrs:{id:"logo-img",src:s("325b"),height:"46"}})]),r("v-spacer"),e.$store.state.isUserLoggedIn||e.minimiseNav?e._e():r("v-toolbar-items",[r("v-btn",{attrs:{depressed:"",to:"/register",color:"white"}},[e._v("Register")]),r("v-btn",{attrs:{depressed:"",to:"/login",color:"white"}},[e._v("Log In")])],1),e.$store.state.isUserLoggedIn&&!e.minimiseNav?r("v-toolbar-items",[r("v-btn",{attrs:{depressed:"",to:"/course/index",color:"white"}},[e._v("My Courses")]),r("v-btn",{staticStyle:{position:"relative"},attrs:{depressed:"",to:"/courses/threads/index",color:"white"}},[e._v("Notifications"),r("div",{attrs:{id:"notification"}},[e._v(e._s(e.notifications))])]),r("v-btn",{attrs:{depressed:"",color:"white"},on:{click:e.logout}},[e._v("Log Out")])],1):e._e(),e.minimiseNav?r("v-app-bar-nav-icon",{on:{click:function(t){e.drawer=!0}}}):e._e()],1),r("v-navigation-drawer",{attrs:{absolute:"",temporary:"",right:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[e.$store.state.isUserLoggedIn?r("v-list",{attrs:{nav:"",dense:""}},[r("v-list-item-group",{attrs:{"active-class":"text--accent-4"}},[r("v-list-item",{attrs:{to:"/"}},[r("v-list-item-icon",[r("v-icon",[e._v("mdi-home")])],1),r("v-list-item-title",[e._v("Home")])],1),r("v-list-item",{attrs:{to:"/course/index"}},[r("v-list-item-icon",[r("v-icon",[e._v("mdi-playlist-music")])],1),r("v-list-item-title",[e._v("My Courses")])],1),r("v-list-item",{on:{click:e.logout}},[r("v-list-item-icon",[r("v-icon",[e._v("mdi-logout")])],1),r("v-list-item-title",[e._v("Log Out")])],1)],1)],1):r("v-list",{attrs:{nav:"",dense:""}},[r("v-list-item-group",{attrs:{"active-class":"text--accent-4"}},[r("v-list-item",{attrs:{to:"/"}},[r("v-list-item-icon",[r("v-icon",[e._v("mdi-home")])],1),r("v-list-item-title",[e._v("Home")])],1),r("v-list-item",{attrs:{to:"/register"}},[r("v-list-item-icon",[r("v-icon",[e._v("mdi-account")])],1),r("v-list-item-title",[e._v("Register")])],1),r("v-list-item",{attrs:{to:"/login"}},[r("v-list-item-icon",[r("v-icon",[e._v("mdi-account")])],1),r("v-list-item-title",[e._v("Log In")])],1)],1)],1)],1)],1)},a=[],c=(s("b0c0"),s("5530")),l=s("2f62"),u={name:"Header",data:function(){return{drawer:!1,messages:0}},methods:{logout:function(){this.$store.dispatch("setToken",null),this.$store.dispatch("setUser",null),this.$router.push("/")}},computed:Object(c["a"])({minimiseNav:function(){switch(this.$vuetify.breakpoint.name){case"xs":return!0;case"sm":return!0;case"md":return!1;case"lg":return!1;case"xl":return!1;default:return!0}}},Object(l["b"])(["user","notifications"])),mounted:function(){}},d=u,h=(s("4a21"),s("2877")),p=s("6544"),m=s.n(p),v=s("40dc"),f=s("5bc1"),g=s("8336"),b=s("132d"),x=s("8860"),w=s("da13"),_=s("1baa"),y=s("34c3"),k=s("5d23"),C=s("f774"),S=s("2fa4"),V=s("2a7f"),T=Object(h["a"])(d,o,a,!1,null,"3b1a47ab",null),N=T.exports;m()(T,{VAppBar:v["a"],VAppBarNavIcon:f["a"],VBtn:g["a"],VIcon:b["a"],VList:x["a"],VListItem:w["a"],VListItemGroup:_["a"],VListItemIcon:y["a"],VListItemTitle:k["b"],VNavigationDrawer:C["a"],VSpacer:S["a"],VToolbarItems:V["a"]});var I={name:"App",components:{"page-header":N},mounted:function(){}},P=I,R=(s("034f"),s("7496")),E=s("f6c4"),O=Object(h["a"])(P,n,i,!1,null,null,null),B=O.exports;m()(O,{VApp:R["a"],VMain:E["a"]});var L=s("8c4f"),M=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("v-container",[s("v-row",{staticClass:"mt-10"},[s("v-col",{staticClass:"text-left",attrs:{cols:"8"}},[s("h1",[e._v("Welcome to Violian!")])])],1),s("v-row",{staticClass:"mb-12"},[s("v-col",{attrs:{cols:"8"}},[s("v-autocomplete",{attrs:{items:e.items,loading:e.isLoading,"search-input":e.search,"cache-items":"",multiple:"",clearable:"","hide-details":"","hide-selected":"","item-text":"name","item-value":"symbol",label:"Search for a course...",solo:""},on:{"update:searchInput":function(t){e.search=t},"update:search-input":function(t){e.search=t}},scopedSlots:e._u([{key:"no-data",fn:function(){return[s("v-list-item",[s("v-list-item-title",[e._v("Search for your favorite "),s("strong",[e._v("Course")])])],1)]},proxy:!0},{key:"item",fn:function(t){var r=t.item;return[s("v-list-item",{on:{click:function(t){return e.go_to_course(t,r.id)}}},[s("v-list-item-content",[e._v(e._s(r.name))])],1)]}}]),model:{value:e.model,callback:function(t){e.model=t},expression:"model"}})],1)],1),s("v-divider"),s("v-row",{staticClass:"mt-10"},[s("v-col",{staticClass:"text-left",attrs:{cols:"12"}},[s("h2",[e._v("Popular Courses")])]),e._l(e.courses,(function(t){return s("v-col",{attrs:{sm:"6",md:"4",lg:"3"}},[s("v-card",{staticClass:"mx-auto"},[t.coverPhotoUrl?s("v-img",{staticClass:"white--text align-end",attrs:{height:"200px",src:t.coverPhotoUrl,gradient:"to top right, rgba(0,0,0,.5), rgba(0,0,0,.5)"}},[s("v-card-title",{staticStyle:{"text-shadow":"1px 1px 2px #000000"}},[e._v(e._s(t.name))])],1):e._e(),s("v-card-subtitle",{staticClass:"pb-0 text-left"},[e._v(e._s(t.instrument))]),s("v-card-text",{staticClass:"text-left text--primary pb-0"},[s("div",[e._v(e._s(t.tagline))])]),s("v-card-actions",[s("v-btn",{attrs:{color:"indigo",text:""},on:{click:function(s){return e.go_to_course(s,t.id)}}},[e._v("Find out more")])],1)],1)],1)}))],2)],1)],1)},U=[],F=(s("96cf"),s("1da1")),A=s("bc3a"),D=s.n(A),j=s("0e44"),$={subscribe:function(e){return W().post("subscribe/new",e)},getSubscriptionInfoOfStudent:function(e){return W().get("subscribe/get/student?uid=".concat(e))},getSubscriptionInfoOfCourse:function(e){return W().get("subscribe/get/course?cid=".concat(e))},isSubscribed:function(e){return W().get("subscribe/get/is-subscribed?cid=".concat(e))},isOwned:function(e){return W().get("subscribe/get/is-owned?cid=".concat(e))}};r["a"].use(l["a"]);var H=new l["a"].Store({strict:!0,plugins:[Object(j["a"])()],state:{token:null,user:null,isUserLoggedIn:!1,notifications:null},mutations:{resetState:function(e){e.token=null,e.notifications=null,e.user=null,e.isUserLoggedIn=!1},setToken:function(e,t){e.token=t},setUser:function(e,t){e.user=t},setNotifications:function(e,t){e.notifications=t},logIn:function(e){e.isUserLoggedIn=!0},logOut:function(e){e.isUserLoggedIn=!1}},actions:{setToken:function(e,t){var s=e.commit;s("setToken",t),t?s("logIn"):(s("logOut"),s("resetState"))},setUser:function(e,t){var s=e.commit;s("setUser",t)},setNotifications:function(e,t){var s=e.commit;s("setNotifications",t)},subscribe:function(e,t){return Object(F["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,$.subscribe(t);case 3:e.dispatch("getCoursesForStudent",{id:t.studentId}),s.next=9;break;case 6:s.prev=6,s.t0=s["catch"](0),console.log(s.t0);case 9:case"end":return s.stop()}}),s,null,[[0,6]])})))()}}}),W=function(){return D.a.create({baseURL:"/api/",headers:{Authorization:"Bearer ".concat(H.state.token)}})},q={create:function(e){return W().post("course/new",e)},list:function(e){return W().get("course/list?uid=".concat(e))},listAll:function(e){return e?W().get("course/listall?search=".concat(e)):W().get("course/listall")},show:function(e){return W().get("course/show?cid=".concat(e))},edit:function(e){var t=W();return t.defaults.headers.put["Content-Type"]="multipart/form-data",t.put("course/edit",e)},delete:function(e){return W().delete("course/del?cid=".concat(e))}},X=s("2ef0"),K=s.n(X),z={name:"Home",data:function(){return{isLoading:!1,items:[],model:null,search:null,courses:[]}},watch:{model:function(e){console.log(e)},search:K.a.debounce(function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(""==t||void 0==t){e.next=13;break}return this.isLoading=!0,e.prev=2,e.next=5,q.listAll(t);case 5:this.items=e.sent.data.courses,this.isLoading=!1,e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](2),this.isLoading=!1,console.log(e.t0);case 13:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(t){return e.apply(this,arguments)}}(),700)},computed:Object(l["b"])(["user","allCourses"]),methods:{go_to_course:function(e,t){this.$router.push({name:"showcourse",params:{course_id:t}})}},mounted:function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,q.listAll();case 2:this.courses=e.sent.data.courses;case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},Y=z,G=s("c6a6"),Z=s("b0af"),J=s("99d9"),Q=s("62ad"),ee=s("a523"),te=s("ce7e"),se=s("adda"),re=s("0fd9"),ne=Object(h["a"])(Y,M,U,!1,null,"38cd4ac5",null),ie=ne.exports;m()(ne,{VAutocomplete:G["a"],VBtn:g["a"],VCard:Z["a"],VCardActions:J["a"],VCardSubtitle:J["b"],VCardText:J["c"],VCardTitle:J["d"],VCol:Q["a"],VContainer:ee["a"],VDivider:te["a"],VImg:se["a"],VListItem:w["a"],VListItemContent:k["a"],VListItemTitle:k["b"],VRow:re["a"]});var oe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"register"}},[s("panel",{attrs:{title:"Register"}},[s("v-card-text",[s("v-form",{ref:"form",staticClass:"text-center",on:{submit:function(t){return t.preventDefault(),e.register(t)}}},[s("v-text-field",{attrs:{label:"Username",name:"username","prepend-icon":"mdi-account",type:"text",rules:e.nameRules},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),s("v-text-field",{attrs:{label:"Email",name:"email","prepend-icon":"mdi-account",type:"text",rules:e.emailRules},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),s("v-text-field",{attrs:{label:"Password",name:"password","prepend-icon":"mdi-lock",type:"password",rules:e.passwordRules},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),s("v-text-field",{attrs:{label:"Password Confirmation",name:"password confirmation","prepend-icon":"mdi-lock",type:"password",rules:e.passwordConfirmationRules},model:{value:e.passwordConfirmation,callback:function(t){e.passwordConfirmation=t},expression:"passwordConfirmation"}}),s("v-radio-group",{attrs:{row:""},model:{value:e.role,callback:function(t){e.role=t},expression:"role"}},[s("v-radio",{attrs:{label:"Student",value:"Student",color:"indigo"}}),s("v-radio",{attrs:{label:"Tutor",value:"Tutor",color:"indigo"}})],1),s("v-spacer"),s("v-btn",{staticClass:"mt-5",attrs:{type:"submit",loading:e.loading,disabled:e.loading}},[e._v("Register")]),s("v-spacer")],1)],1),s("v-card-text",[s("div",{staticClass:"error",domProps:{innerHTML:e._s(e.error)}},[e._v(e._s(e.error))])])],1)],1)},ae=[],ce=(s("4d63"),s("ac1f"),s("25f0"),{register:function(e){return W().post("register",e)},login:function(e){return W().post("login",e)},adminLogin:function(e){return W().post("admin-login",e)}}),le={name:"Register",data:function(){var e=this;return{username:"",nameRules:[function(e){return!!e||"Username is required"},function(e){return new RegExp(/^[a-zA-Z ]{2,30}$/).test(e)||"Name must be alphanumeric characters and of length 2 - 32"}],email:"",emailRules:[function(e){return!!e||"E-mail is required"},function(e){return/.+@.+\..+/.test(e)||"E-mail must be valid"}],password:"",passwordRules:[function(e){return!!e||"Password is required"},function(e){return new RegExp("^[a-zA-Z0-9]{8,32}$").test(e)||"Password must be alphanumeric characters and of length 8 - 32"}],passwordConfirmation:"",passwordConfirmationRules:[function(e){return!!e||"Password confirmation is required"},function(t){return t==e.password||"Passwords don't match"}],error:null,loading:!1,role:""}},methods:{register:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$refs.form.validate()){t.next=2;break}return t.abrupt("return");case 2:return e.error="",e.loading=!0,t.prev=4,t.next=7,ce.register({username:e.username,email:e.email,password:e.password,role:e.role});case 7:s=t.sent,e.loading=!1,e.$store.dispatch("setToken",s.data.token),e.$store.dispatch("setUser",s.data.user),e.$router.push("/"),t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](4),e.error=t.t0.response.data.error,e.loading=!1;case 18:case"end":return t.stop()}}),t,null,[[4,14]])})))()}}},ue=le,de=s("4bd4"),he=s("67b6"),pe=s("43a6"),me=s("8654"),ve=Object(h["a"])(ue,oe,ae,!1,null,"1d878e14",null),fe=ve.exports;m()(ve,{VBtn:g["a"],VCardText:J["c"],VForm:de["a"],VRadio:he["a"],VRadioGroup:pe["a"],VSpacer:S["a"],VTextField:me["a"]});var ge=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"login"}},[s("panel",{attrs:{title:"Log In"}},[s("v-card-text",[s("v-form",{ref:"form",staticClass:"text-center",on:{submit:function(t){return t.preventDefault(),e.login(t)}}},[s("v-text-field",{attrs:{label:"Email",name:"email","prepend-icon":"mdi-account",type:"text",rules:e.emailRules},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),s("v-text-field",{attrs:{id:"password",label:"Password",name:"password","prepend-icon":"mdi-lock",type:"password",rules:e.passwordRules},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),s("v-spacer"),s("v-btn",{staticClass:"mt-5",attrs:{loading:e.loading,disabled:e.loading,type:"submit"}},[e._v("Log In")]),s("v-spacer")],1)],1),s("v-card-text",[s("div",{staticClass:"error text-center",domProps:{innerHTML:e._s(e.error)}},[e._v(e._s(e.error))])])],1)],1)},be=[],xe=(s("4160"),s("159b"),{name:"LogIn",data:function(){return{email:"",emailRules:[function(e){return!!e||"E-mail is required"},function(e){return/.+@.+\..+/.test(e)||"E-mail must be valid"}],password:"",passwordRules:[function(e){return!!e||"Password is required"}],error:null,loading:!1}},methods:{login:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){var s,r,n,i,o,a,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$refs.form.validate()){t.next=2;break}return t.abrupt("return");case 2:return e.error="",e.loading=!0,t.prev=4,t.next=7,ce.login({email:e.email,password:e.password});case 7:if(s=t.sent,e.loading=!1,e.$store.dispatch("setToken",s.data.token),e.$store.dispatch("setUser",s.data.user),!s.data.user.isStudent){t.next=21;break}return t.next=14,$.getSubscriptionInfoOfStudent(s.data.user.id);case 14:r=t.sent,n=r.data.courses,i=0,n.forEach((function(e){return i+=e.unreadTutorPost})),e.$store.dispatch("setNotifications",i),t.next=28;break;case 21:return t.next=23,q.list(s.data.user.id);case 23:o=t.sent,a=o.data.courses,c=0,a.forEach((function(e){return c+=e.unreadStudentPost})),e.$store.dispatch("setNotifications",c);case 28:e.$router.push({name:"home"}),t.next=35;break;case 31:t.prev=31,t.t0=t["catch"](4),e.error=t.t0.response.data.error,e.loading=!1;case 35:case"end":return t.stop()}}),t,null,[[4,31]])})))()}}}),we=xe,_e=Object(h["a"])(we,ge,be,!1,null,"40f80db3",null),ye=_e.exports;m()(_e,{VBtn:g["a"],VCardText:J["c"],VForm:de["a"],VSpacer:S["a"],VTextField:me["a"]});var ke=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.course?r("div",{attrs:{id:"show-course",fluid:""}},[r("v-container",{attrs:{id:"course-info",fluid:""}},[r("v-row",{staticClass:"px-sm-16 mx-md-8 mx-lg-16"},[r("v-col",{attrs:{cols:"12",md:"8"}},[r("v-row",[r("v-col",{staticClass:"text-left"},[r("h1",{staticClass:"font-weight-bold",staticStyle:{"font-size":"40px","line-height":"1.2"}},[e._v(e._s(e.course.name))])])],1),r("v-row",[r("v-col",{staticClass:"pt-0"},[r("h3",[e._v(e._s(e.course.description))])])],1),r("v-row",[r("v-col",{attrs:{sm:"4",lg:"3"}},[r("v-row",[r("v-col",{staticClass:"pr-0",attrs:{sm:"4",md:"3"}},[r("v-icon",{attrs:{color:"white",size:"30"}},[e._v("mdi-guitar-acoustic")])],1),r("v-col",{staticClass:"my-auto",attrs:{sm:"8",md:"9"}},[r("p",{staticClass:"ma-0"},[e._v("Instrument: "+e._s(e.course.instrument))])])],1)],1),r("v-col",{attrs:{sm:"4",lg:"3"}},[r("v-row",[r("v-col",{staticClass:"pr-0",attrs:{sm:"4",md:"3"}},[r("v-icon",{attrs:{color:"white",size:"24"}},[e._v("mdi-earth")])],1),r("v-col",{staticClass:"my-auto",attrs:{sm:"8",md:"9"}},[r("p",{staticClass:"ma-0"},[e._v(e._s(e.course.language))])])],1)],1),r("v-col",{attrs:{sm:"4",lg:"3"}},[r("v-row",[r("v-col",{staticClass:"pr-0",attrs:{sm:"4",md:"3"}},[r("v-icon",{attrs:{color:"white",size:"24"}},[e._v("mdi-calendar-clock")])],1),r("v-col",{staticClass:"my-auto",attrs:{sm:"8",md:"9"}},[r("p",{staticClass:"ma-0"},[e._v("Last updated: "+e._s(new Date(e.course.updatedAt).toLocaleString([],{year:"numeric",month:"numeric",day:"numeric"})))])])],1)],1)],1)],1),null==e.user||e.user.isStudent&&!e.isSubscribed?r("v-col",{attrs:{cols:"12",md:"4"}},[r("v-card",[r("v-img",{staticClass:"white--text align-end",staticStyle:{cursor:"pointer"},attrs:{gradient:"to top right, rgba(0,0,0,.5), rgba(0,0,0,.5)",height:"200px",src:e.course.coverPhotoUrl},on:{click:e.playVideo}},[r("div",{staticStyle:{position:"absolute",left:"0",top:"0",width:"100%",height:"100%"}},[r("img",{staticStyle:{position:"absolute",width:"60px",left:"calc(50% - 30px)",top:"calc(50% - 30px)",height:"60px"},attrs:{id:"play-button",src:s("b020"),color:"white",size:"62"}}),r("h3",{staticClass:"text--white",staticStyle:{bottom:"12px","text-align":"center",position:"absolute",left:"0",right:"0","text-shadow":"1px 1px 2px #000000"}},[e._v("Preview this course")])])]),r("v-row",[r("v-col",{staticClass:"text-left"},[r("h1",{staticClass:"pl-5 font-weight-bold",staticStyle:{"font-size":"36px"}},[e._v("S$"+e._s(e.course.price.toFixed(2)))])])],1),r("v-row",[r("v-col",{staticClass:"text-center"},[0==e.course.price?r("v-btn",{staticStyle:{width:"90%"},attrs:{color:"#ec5252",dark:"","x-large":""},on:{click:e.subscribe}},[e._v("Enroll Now")]):r("v-btn",{staticStyle:{width:"90%"},attrs:{color:"#ec5252",dark:"","x-large":""},on:{click:e.subscribe}},[e._v("Buy Now")])],1)],1)],1)],1):e._e(),e.isSubscribed||e.isOwned?r("v-col",{staticClass:"my-auto",attrs:{cols:"12",md:"4"}},[r("v-row",[r("v-col",{staticClass:"text-center"},[r("v-btn",{staticStyle:{width:"90%"},attrs:{color:"#26A69A",dark:"","x-large":""},on:{click:function(t){return e.goToLesson(t,e.course.lessons[0])}}},[e._v("Start Learning!")])],1)],1)],1):e._e()],1)],1),e.course.learningPoints?r("v-container",{attrs:{fluid:""}},[r("v-row",{staticClass:"px-sm-16 mx-md-8 mx-lg-16"},[r("v-col",{attrs:{cols:"12"}},[r("v-sheet",{staticClass:"px-16 py-5",staticStyle:{border:"1px solid #E0E0E0"},attrs:{color:"#fbfbf8",rounded:""}},[r("v-row",[r("v-col",{staticClass:"py-0 px-0"},[r("h2",{staticClass:"py-3 pl-0",staticStyle:{color:"#3c3b37","font-size":"30px"}},[e._v("What you will learn")])])],1),r("v-row",e._l(e.course.learningPoints.split("&"),(function(t,s){return r("v-col",{key:s,staticClass:"py-0 px-0",attrs:{cols:"12",md:"6"}},[r("v-row",[r("v-col",{staticClass:"py-2 pr-0",attrs:{cols:"1"}},[r("v-icon",{staticClass:"d-inline mb-2",attrs:{size:"16",color:"#ec5252"}},[e._v("mdi-star")])],1),r("v-col",{staticClass:"py-2 pr-0",attrs:{cols:"10"}},[r("p",{staticClass:"d-inline mb-0 text-uppercase",staticStyle:{"line-height":"1","vertical-align":"middle"}},[e._v(e._s(t))])])],1)],1)})),1)],1)],1)],1)],1):e._e(),r("v-container",{attrs:{fluid:""}},[r("v-row",{staticClass:"px-sm-16 mx-md-8 mx-lg-16"},[r("v-col",{attrs:{cols:"12"}},[r("v-sheet",{staticClass:"px-16 py-5"},[r("v-row",[r("v-col",{staticClass:"py-0 px-0"},[r("h2",{staticClass:"py-3",staticStyle:{color:"#3c3b37","font-size":"30px"}},[e._v("About the course")]),r("p",[e._v(e._s(e.course.description))])])],1)],1)],1)],1)],1),e.course.requirements?r("v-container",{attrs:{fluid:""}},[r("v-row",{staticClass:"px-sm-16 mx-md-8 mx-lg-16"},[r("v-col",{attrs:{cols:"12"}},[r("v-sheet",{staticClass:"px-16 py-5"},[r("v-row",[r("v-col",{staticClass:"py-0 px-0"},[r("h2",{staticClass:"pl-0",staticStyle:{color:"#3c3b37","font-size":"30px"}},[e._v("Prerequisites for this Course")])])],1),e._l(e.course.requirements.split("&"),(function(t,s){return r("v-row",{key:s,attrs:{align:"start"}},[r("v-col",{staticClass:"py-0 px-0",attrs:{cols:"6"}},[r("v-row",[r("v-col",{staticClass:"pr-0",attrs:{cols:"1","align-self":"center"}},[r("v-icon",{staticClass:"d-inline mb-2",attrs:{size:"30",color:"#ec5252"}},[e._v("mdi-square-small")])],1),r("v-col",{staticClass:"pr-0",attrs:{cols:"10","align-self":"center"}},[r("p",{staticClass:"d-inline mb-0",staticStyle:{"line-height":"1"}},[e._v(e._s(t))])])],1)],1),r("v-col",{staticClass:"py-0 px-0",attrs:{cols:"6"}})],1)}))],2)],1)],1)],1):e._e(),e.course.targetAudiences?r("v-container",{attrs:{fluid:""}},[r("v-row",{staticClass:"px-sm-16 mx-md-8 mx-lg-16"},[r("v-col",{attrs:{cols:"12"}},[r("v-sheet",{staticClass:"px-16 py-5"},[r("v-row",[r("v-col",{staticClass:"py-0 px-0"},[r("h2",{staticClass:"pl-0",staticStyle:{color:"#3c3b37","font-size":"30px"}},[e._v("Who's suitable for the course")])])],1),e._l(e.course.targetAudiences.split("&"),(function(t,s){return r("v-row",{key:s,attrs:{align:"start"}},[r("v-col",{staticClass:"py-0 px-0",attrs:{cols:"6"}},[r("v-row",[r("v-col",{staticClass:"pr-0 py-0",attrs:{cols:"1","align-self":"center"}},[r("v-icon",{staticClass:"d-inline mb-2",attrs:{size:"30",color:"#ec5252"}},[e._v("mdi-square-small")])],1),r("v-col",{staticClass:"pr-0",attrs:{cols:"10","align-self":"center"}},[r("p",{staticClass:"d-inline mb-0",staticStyle:{"line-height":"1"}},[e._v(e._s(t))])])],1)],1),r("v-col",{staticClass:"py-0 px-0",attrs:{cols:"6"}})],1)}))],2)],1)],1)],1):e._e(),r("v-container",{attrs:{fluid:""}},[r("v-row",{staticClass:"px-sm-16 mx-md-8 mx-lg-16"},[r("v-col",{attrs:{cols:"12"}},[r("v-sheet",{staticClass:"px-16 py-5"},[r("v-row",[r("v-col",{staticClass:"py-0 px-0"},[r("h2",{staticClass:"pl-0 pb-2",staticStyle:{color:"#3c3b37","font-size":"30px"}},[e._v("Course Content")]),r("div",{staticStyle:{color:"#9E9E9E","font-size":"16px"}},[e._v(e._s(e.course.lessons.length)+" Lessons  "+e._s(e.timeConverted)+" of video content")])])],1),r("v-row",{attrs:{align:"start"}},[r("v-col",{staticClass:"px-0",attrs:{cols:"12"}},[r("v-card",[r("v-toolbar",{attrs:{color:"grey lighten-2",light:"",flat:""}},[r("v-toolbar-title",[e._v(e._s(e.course.name))]),r("v-spacer"),r("v-btn",{attrs:{icon:""}},[r("v-icon",[e._v("mdi-unfold-more-horizontal")])],1)],1),r("v-list",e._l(e.course.lessons,(function(t,s){return r("v-list-item",{key:t.id,attrs:{shaped:"",disabled:0!=s},on:{click:function(s){return e.goToLesson(s,t)}}},[r("v-list-item-icon",0==s?[r("v-icon",{attrs:{color:"#ec5252"}},[e._v("mdi-play")])]:[r("v-icon",{attrs:{color:"rgba(0, 0, 0, 0.38)"}},[e._v("mdi-play")])],1),r("v-list-item-content",[r("v-list-item-title",{domProps:{textContent:e._s(t.name)}})],1),r("v-spacer"),r("v-list-item-icon",[r("div",[e._v(e._s(t.duration)+" mins")])])],1)})),1)],1)],1)],1)],1)],1)],1)],1),r("v-row",{attrs:{justify:"center"}},[e.dialog?r("v-dialog",{attrs:{"max-width":"calc(100vw * 0.8)"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[r("video",{ref:"videoPlayer",attrs:{width:"100%",height:"auto",controls:"",id:"video"}},[r("source",{attrs:{src:e.course.previewVideoUrl,type:"video/mp4"}})])]):e._e()],1)],1):e._e()},Ce=[],Se=(s("d81d"),s("d3b7"),s("3ca3"),s("ddb0"),s("99af"),{create:function(e){return W().post("thread/new",e)},list:function(e){return W().get("thread/list?lid=".concat(e))},show:function(e,t){return W().get("thread/show?lid=".concat(e,"&uid=").concat(t))},delete:function(e){return W().delete("thread/del?tid=".concat(e))},getUnread:function(e,t){return W().get("thread/unread?cid=".concat(e,"&uid=").concat(t))}}),Ve={name:"ShowCourse",data:function(){return{course:null,dialog:!1,error:null,tab:null,isSubscribed:!1,isOwned:!1,player:null}},computed:Object(c["a"])({timeConverted:function(){var e=this.course.duration,t=e/60,s=Math.floor(t),r=60*(t-s),n=Math.round(r);return 0==s?n+" minute(s)":s+" hour(s) and "+n+" minute(s)"}},Object(l["b"])(["user"])),watch:{dialog:function(e){if(0==e)return!1}},methods:{goToLesson:function(e,t){this.$router.push({name:"showlesson",params:{course_id:this.course.id,lesson_id:t.id,course:this.course,lesson:t}})},playVideo:function(){this.dialog=!0},subscribe:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!=e.course.price){t.next=12;break}if(!e.user){t.next=9;break}return t.next=4,Promise.all(e.course.lessons.map(function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(t){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Se.create({lid:t.id});case 2:return s=e.sent,s.data.thread.posts=[],t.thread=s.data.thread,e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:return t.next=6,e.$store.dispatch("subscribe",{studentId:e.$store.state.user.id,courseId:e.course.id});case 6:e.$router.push({name:"showlesson",params:{course_id:e.course.id,lesson_id:e.course.lessons[0].id}}),t.next=10;break;case 9:alert("Please register or login first");case 10:t.next=13;break;case 12:e.$router.push("/payment/".concat(e.course.id));case 13:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,q.show(e.$route.params.course_id);case 3:s=t.sent,e.course=s.data.course,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.log(t.t0);case 10:if(!e.user){t.next=20;break}if(!e.user.isStudent){t.next=17;break}return t.next=14,$.isSubscribed(e.course.id);case 14:e.isSubscribed=t.sent.data.isSubscribed,t.next=20;break;case 17:return t.next=19,$.isOwned(e.course.id);case 19:e.isOwned=t.sent.data.isOwned;case 20:case"end":return t.stop()}}),t,null,[[0,7]])})))()}},Te=Ve,Ne=(s("6a72"),s("169a")),Ie=s("8dd9"),Pe=s("71d9"),Re=Object(h["a"])(Te,ke,Ce,!1,null,"09c15db4",null),Ee=Re.exports;m()(Re,{VBtn:g["a"],VCard:Z["a"],VCol:Q["a"],VContainer:ee["a"],VDialog:Ne["a"],VIcon:b["a"],VImg:se["a"],VList:x["a"],VListItem:w["a"],VListItemContent:k["a"],VListItemIcon:y["a"],VListItemTitle:k["b"],VRow:re["a"],VSheet:Ie["a"],VSpacer:S["a"],VToolbar:Pe["a"],VToolbarTitle:V["b"]});var Oe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mt-5",attrs:{id:"courses"}},[s("panel",{attrs:{title:"All Courses",md:"9"}},[e.is_student?s("v-list",e._l(e.courses,(function(t){return s("v-list-item",{key:t.id,on:{click:function(s){return e.showCourse(s,t.id,t.lessons[0].id)}}},[s("v-list-item-content",[s("v-list-item-title",{staticClass:"text-h5 py-0",domProps:{textContent:e._s(t.name)}})],1)],1)})),1):s("v-list",e._l(e.courses,(function(t){return s("v-list-item",{key:t.id},[s("v-list-item-content",{staticClass:"clickable-content mx-2 px-2",on:{click:function(s){return e.showCourse(s,t.id,t.lessons[0].id)}}},[s("v-list-item-title",{staticClass:"text-h5 py-0",domProps:{textContent:e._s(t.name)}})],1),s("v-list-item-icon",[s("v-btn",{attrs:{outlined:"",color:"indigo"},on:{click:function(s){return e.editCourse(s,t)}}},[s("v-icon",[e._v("mdi-pencil")])],1)],1),s("v-list-item-icon",[s("v-btn",{attrs:{outlined:"",color:"indigo"},on:{click:function(s){return e.deleteCourse(s,t)}}},[s("v-icon",[e._v("mdi-trash-can-outline")])],1)],1)],1)})),1)],1),e.is_student?e._e():s("v-row",{attrs:{justify:"center"}},[s("v-btn",{staticClass:"mt-5",attrs:{"x-large":"",to:"/course/new"}},[s("v-icon",{attrs:{left:"",dark:""}},[e._v("mdi-plus-thick")]),e._v("New Course")],1)],1)],1)},Be=[],Le={show:function(e){return W().get("lesson/show?lid=".concat(e))},create:function(e){return W().post("lesson/new",e)},list:function(e){return W().get("lesson/list?cid=".concat(e))},edit:function(e){return W().put("lesson/edit",e)},delete:function(e){return W().delete("lesson/del?lid=".concat(e))}},Me={data:function(){return{courses:[]}},computed:Object(c["a"])({is_student:function(){return this.user.isStudent}},Object(l["b"])(["user"])),methods:{showCourse:function(e,t,s){this.$router.push({name:"showlesson",params:{course_id:t,lesson_id:s}})},deleteCourse:function(e,t){var s=this;return Object(F["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!confirm("Are you sure?")){e.next=5;break}return e.next=3,Promise.all(t.lessons.map((function(e){return Le.delete(e.id)})));case 3:return e.next=5,q.delete(t.id);case 5:s.$router.go();case 6:case"end":return e.stop()}}),e)})))()},editCourse:function(e,t){this.$router.push("/course/edit/".concat(t.id))}},mounted:function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.is_student){e.next=6;break}return e.next=3,$.getSubscriptionInfoOfStudent(this.user.id);case 3:this.courses=e.sent.data.courses,e.next=9;break;case 6:return e.next=8,q.list(this.user.id);case 8:this.courses=e.sent.data.courses;case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},Ue=Me,Fe=(s("d449"),Object(h["a"])(Ue,Oe,Be,!1,null,"548f87ae",null)),Ae=Fe.exports;m()(Fe,{VBtn:g["a"],VIcon:b["a"],VList:x["a"],VListItem:w["a"],VListItemContent:k["a"],VListItemIcon:y["a"],VListItemTitle:k["b"],VRow:re["a"]});var De=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"new-course"}},[s("v-stepper",{staticStyle:{"min-height":"calc(100vh - 64px"},model:{value:e.e1,callback:function(t){e.e1=t},expression:"e1"}},[s("v-stepper-header",[s("v-stepper-step",{attrs:{complete:e.e1>1,step:"1",color:"indigo"}},[e._v("Step 1")]),s("v-divider"),s("v-stepper-step",{attrs:{complete:e.e1>2,step:"2",color:"indigo"}},[e._v("Step 2")]),s("v-divider"),s("v-stepper-step",{attrs:{step:"3",color:"indigo"}},[e._v("Step 3")])],1),s("v-stepper-items",[s("v-stepper-content",{staticClass:"text-center",attrs:{step:"1"}},[s("v-container",[s("v-form",{ref:"nameForm",on:{submit:function(t){return t.preventDefault(),e.goStepTwo(t)}}},[s("v-row",{staticClass:"mb-8"},[s("v-col",[s("h1",{staticClass:"font-weight-bold"},[e._v("First, give your course a title")])])],1),s("v-row",{staticClass:"mb-16"},[s("v-col",[s("v-text-field",{staticClass:"mx-auto",staticStyle:{width:"60vw"},attrs:{label:"Name",type:"text",rules:e.requiredRules,outlined:"",color:"indigo"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1)],1)],1),s("v-row",{staticClass:"justify-center"},[s("v-col",{staticClass:"text-center"},[s("v-btn",{attrs:{color:"indigo",dark:""},on:{click:e.goStepTwo}},[e._v("Continue")]),s("v-btn",{attrs:{to:"/course/index"}},[e._v("Cancel")])],1)],1)],1)],1),s("v-stepper-content",{staticClass:"text-center",attrs:{step:"2"}},[s("v-container",[s("v-form",{ref:"instrumentForm",on:{submit:function(t){return t.preventDefault(),e.goStepThree(t)}}},[s("v-row",{staticClass:"mb-8"},[s("v-col",[s("h1",{staticClass:"font-weight-bold"},[e._v("What instrument are you teaching?")])])],1),s("v-row",{staticClass:"mb-16"},[s("v-col",[s("v-select",{staticClass:"mx-auto",staticStyle:{width:"60vw"},attrs:{label:"Instrument",items:e.instruments,outlined:"",color:"indigo"},model:{value:e.instrument,callback:function(t){e.instrument=t},expression:"instrument"}})],1)],1)],1),s("v-row",{staticClass:"justify-center"},[s("v-col",{staticClass:"text-center"},[s("v-btn",{attrs:{color:"indigo",dark:""},on:{click:e.goStepThree}},[e._v("Continue")]),s("v-btn",{attrs:{to:"/course/index"}},[e._v("Cancel")])],1)],1)],1)],1),s("v-stepper-content",{staticClass:"text-center",attrs:{step:"3"}},[s("v-container",[s("v-form",{ref:"languageForm",on:{submite:function(t){return t.preventDefault(),e.submit(t)}}},[s("v-row",{staticClass:"mb-8"},[s("v-col",[s("h1",{staticClass:"font-weight-bold"},[e._v("What language do you use?")])])],1),s("v-row",{staticClass:"mb-16"},[s("v-col",[s("v-select",{staticClass:"mx-auto",staticStyle:{width:"60vw"},attrs:{label:"Language",items:e.languages,outlined:"",color:"indigo"},model:{value:e.language,callback:function(t){e.language=t},expression:"language"}})],1)],1)],1),s("v-row",{staticClass:"justify-center"},[s("v-col",{staticClass:"text-center"},[s("v-btn",{attrs:{color:"indigo",dark:""},on:{click:e.submit}},[e._v("Create Course")]),s("v-btn",{attrs:{to:"/course/index"}},[e._v("Cancel")])],1)],1)],1)],1)],1)],1)],1)},je=[],$e={name:"NewCourse",data:function(){return{e1:1,name:"",publishNow:!1,nameRules:[function(e){return!!e||"Title is required"}],languages:["English","Chinese","Malay"],language:"",instrument:"",instruments:["Piano","Guitar","Drum Set","Er Hu","Yang Qin","French Horn","Violin","Body Percussion"],requiredRules:[function(e){return!!e||"This field is required"}]}},computed:Object(l["b"])(["user"]),methods:{goStepTwo:function(){this.$refs.nameForm.validate()&&(this.e1=2)},goStepThree:function(){this.$refs.instrumentForm.validate()&&(this.e1=2),this.e1=3},submit:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){var s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.loading=!0,e.error="",t.prev=2,!e.$refs.languageForm.validate()){t.next=15;break}return s=new FormData,s.set("name",e.name),s.set("language",e.language),s.set("instrument",e.instrument),s.set("TutorId",e.user.id),s.set("publishNow",e.publishNow),t.next=12,q.create(s);case 12:r=t.sent,e.loading=!1,e.$router.push("/course/edit/".concat(r.data.course.id));case 15:t.next=21;break;case 17:t.prev=17,t.t0=t["catch"](2),console.log(t.t0),e.error=t.t0.response.data.error;case 21:case"end":return t.stop()}}),t,null,[[2,17]])})))()}}},He=$e,We=(s("da33"),s("b974")),qe=s("7e85"),Xe=s("e516"),Ke=s("9c54"),ze=s("56a4"),Ye=Object(h["a"])(He,De,je,!1,null,"0ec95fc7",null),Ge=Ye.exports;m()(Ye,{VBtn:g["a"],VCol:Q["a"],VContainer:ee["a"],VDivider:te["a"],VForm:de["a"],VRow:re["a"],VSelect:We["a"],VStepper:qe["a"],VStepperContent:Xe["a"],VStepperHeader:Ke["a"],VStepperItems:Ke["b"],VStepperStep:ze["a"],VTextField:me["a"]});var Ze=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.course?s("v-container",[s("v-row",{staticClass:"justify-center"},[s("v-col",{attrs:{cols:"12"}},[s("v-card",{staticClass:"text-left mb-12",attrs:{outlined:""}},[s("v-card-title",{staticClass:"display-1 px-10"},[e._v("Course Info"),s("v-spacer"),s("v-btn",{attrs:{outlined:"",color:"indigo",right:""},on:{click:e.editCourse}},[s("v-icon",{attrs:{color:"indigo"}},[e._v("mdi-pencil")])],1)],1),s("v-divider"),s("v-card-text",{staticClass:"px-10"},[s("v-row",[s("v-col",{attrs:{cols:"12",md:"4"}},[s("strong",[e._v("Title: ")]),e._v(e._s(e.course.name))]),s("v-col",{attrs:{cols:"12",md:"4"}},[s("strong",[e._v("Price: ")]),e._v("S$ "+e._s(e.course.price))]),s("v-col",{attrs:{cols:"12",md:"4"}},[s("strong",[e._v("Tagline: ")]),e._v(e._s(e.course.tagline))])],1),s("v-row",[s("v-col",{attrs:{cols:"12"}},[s("strong",[e._v("Description: ")]),e._v(e._s(e.course.description))])],1),s("v-row",[s("v-col",{attrs:{cols:"12",md:"4"}},[s("strong",[e._v("Level: ")]),e._v(e._s(e.course.level))]),s("v-col",{attrs:{cols:"12",md:"4"}},[s("strong",[e._v("Instrument: ")]),e._v(e._s(e.course.instrument))]),s("v-col",{attrs:{cols:"12",md:"4"}},[s("strong",[e._v("Language: ")]),e._v(e._s(e.course.language))])],1),s("v-row",[e.course.previewVideoUrl?s("v-col",{attrs:{cols:"12",md:"4"}},[s("strong",[e._v("Preview video: ")]),e._v(e._s(e.course.previewVideoUrl.split("/")[6]))]):e._e(),e.course.coverPhotoUrl?s("v-col",{attrs:{cols:"12",md:"4"}},[s("strong",[e._v("Cover photo: ")]),e._v(e._s(e.course.coverPhotoUrl.split("/")[6]))]):e._e()],1),e.course.learningPoints?s("v-row",[s("v-col",{attrs:{cols:"12"}},[s("strong",[e._v("What your student will learn:")])]),e._l(e.course.learningPoints.split("&"),(function(t,r){return s("v-col",{key:r,staticClass:"py-0",attrs:{cols:"12"}},[s("p",[e._v(e._s(t))])])}))],2):e._e(),e.course.targetAudiences?s("v-row",[s("v-col",{attrs:{cols:"12"}},[s("strong",[e._v("Who are this course for?")])]),e._l(e.course.targetAudiences.split("&"),(function(t,r){return s("v-col",{key:r,staticClass:"py-0",attrs:{cols:"12"}},[s("p",[e._v(e._s(t))])])}))],2):e._e(),e.course.requirements?s("v-row",[s("v-col",{attrs:{cols:"12"}},[s("strong",[e._v("What are the requirements?")])]),e._l(e.course.requirements.split("&"),(function(t,r){return s("v-col",{key:r,staticClass:"py-0",attrs:{cols:"12"}},[s("p",[e._v(e._s(t))])])}))],2):e._e()],1)],1)],1)],1),s("v-row",{staticClass:"justify-center mt-5"},[s("v-col",{attrs:{cols:"12"}},[s("v-card",{staticClass:"text-left mb-12 pb-5",attrs:{outlined:""}},[s("v-card-title",{staticClass:"display-1 px-10"},[e._v("Lessons"),s("v-spacer"),s("v-btn",{attrs:{outlined:"",color:"indigo",right:""},on:{click:e.newLesson}},[s("v-icon",{attrs:{color:"indigo"}},[e._v("mdi-plus")])],1)],1),s("v-divider"),e._l(e.course.lessons,(function(t,r){return s("v-card-text",{key:r,staticClass:"px-10 pb-0"},[s("v-row",[s("v-col",{attrs:{cols:"12",md:"4"}},[s("strong",[e._v("Name: ")]),e._v(e._s(t.name))]),s("v-col",{attrs:{cols:"12",md:"4"}},[s("strong",[e._v("Duration: ")]),e._v(e._s(t.duration))]),s("v-spacer"),s("v-btn",{staticClass:"mr-3",attrs:{outlined:"",color:"indigo",right:""},on:{click:function(s){return e.editLesson(s,t)}}},[s("v-icon",{attrs:{color:"indigo"}},[e._v("mdi-pencil")])],1)],1),r!=e.course.lessons.length-1?s("v-divider"):e._e()],1)}))],2)],1)],1),s("v-row",{staticClass:"justify-center"},[s("v-col",{staticClass:"text-center"},[e.course.publishNow?s("v-btn",{attrs:{color:"indigo",dark:"",to:"/course/index"}},[e._v("Confirm")]):s("v-btn",{attrs:{color:"indigo",dark:""},on:{click:e.publishCourse}},[e._v("Publish Now")]),s("v-btn",{attrs:{to:"/course/index"}},[e._v("Cancel")])],1)],1)],1):e._e()},Je=[],Qe={create:function(e){var t=W();return t.defaults.headers.post["Content-Type"]="multipart/form-data",t.post("exercise/new",e)},list:function(e){return W().get("exercise/list?lid=".concat(e))},edit:function(e){var t=W();return t.defaults.headers.post["Content-Type"]="multipart/form-data",t.put("exercise/edit",e)},delete:function(e){return W().delete("exercise/del?eid=".concat(e))}},et=s("359f"),tt={name:"editCourse",data:function(){return{course:null}},computed:Object(l["b"])(["user"]),methods:{editCourse:function(){this.$router.push("/course/form/".concat(this.course.id))},editLesson:function(e,t){this.$router.push("/lesson/edit-form/".concat(t.id))},newLesson:function(e,t){this.$router.push("/lesson/new-form/".concat(this.course.id))},publishCourse:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=new FormData,s.set("id",e.course.id),s.set("publishNow",!0),t.next=5,q.edit(s);case 5:e.$router.push("/");case 6:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,q.show(this.$route.params.course_id);case 3:t=e.sent,this.course=t.data.course,e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}()},st=tt,rt=(s("3730"),Object(h["a"])(st,Ze,Je,!1,null,"4caa4ae9",null)),nt=rt.exports;m()(rt,{VBtn:g["a"],VCard:Z["a"],VCardText:J["c"],VCardTitle:J["d"],VCol:Q["a"],VContainer:ee["a"],VDivider:te["a"],VIcon:b["a"],VRow:re["a"],VSpacer:S["a"]});var it=function(){var e=this,t=e.$createElement,s=e._self._c||t;return"wangrunding@gmail.com"==e.user.email?s("div",{attrs:{id:"student"}},[s("panel",{attrs:{title:"Users",md:"10"}},[s("v-list",e._l(e.allUsers,(function(t){return s("v-list-item",{key:t.id},[s("v-list-item-content",[s("v-list-item-title",{staticClass:"mr-5",domProps:{textContent:e._s(t.username)}})],1),s("v-list-item-content",[s("v-list-item-title",{staticClass:"mr-5",domProps:{textContent:e._s(t.email)}})],1),s("v-list-item-content",[t.isStudent?s("v-list-item-title",{staticClass:"mr-5"},[e._v("Student")]):s("v-list-item-title",{staticClass:"mr-5"},[e._v("Tutor")])],1),s("v-list-item-icon",[s("v-btn",{attrs:{icon:""}},[s("v-icon",{on:{click:function(s){return e.login(s,t)}}},[e._v("mdi-eye")])],1)],1)],1)})),1)],1)],1):e._e()},ot=[],at={getAllUsers:function(){return W().get("user/list")},getAllStudents:function(){return W().get("student/list")},getAllTutors:function(){return W().get("tutor/list")}},ct={name:"UserIndex",data:function(){return{allUsers:[]}},computed:Object(l["b"])(["user"]),methods:{login:function(e,t){var s=this;return Object(F["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ce.adminLogin({email:t.email});case 3:r=e.sent,s.$store.dispatch("setToken",r.data.token),s.$store.dispatch("setUser",r.data.user),s.$router.push({name:"home"}),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](0),s.error=e.t0.response.data.error,s.loading=!1;case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))()}},mounted:function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,at.getAllUsers();case 2:this.allUsers=e.sent.data.users;case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},lt=ct,ut=Object(h["a"])(lt,it,ot,!1,null,"2cbf6e4c",null),dt=ut.exports;m()(ut,{VBtn:g["a"],VIcon:b["a"],VList:x["a"],VListItem:w["a"],VListItemContent:k["a"],VListItemIcon:y["a"],VListItemTitle:k["b"]});var ht=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("v-container",[s("v-row",[s("v-col",[s("v-form",[s("v-row",[s("v-col",{attrs:{cols:"4"}},[s("v-file-input",{attrs:{accept:"video/mp4, video/ogg",placeholder:"Choose Explanation Video","prepend-icon":"mdi-video",label:"Explanation Video"},model:{value:e.video,callback:function(t){e.video=t},expression:"video"}})],1),s("v-col",{attrs:{cols:"4"}},[s("div",{attrs:{id:"wrapper"}},[s("v-progress-linear",{attrs:{value:e.progress,height:"10",striped:"",rounded:"",color:e.color}})],1)])],1),s("v-btn",{on:{click:e.submit}},[e._v("Submit")])],1)],1)],1),s("v-row",[s("v-col",{attrs:{cols:"4"}},[s("video",{staticStyle:{width:"100%"},attrs:{src:e.src,controls:""}})])],1),s("v-row",[s("v-col",[s("v-btn",{on:{click:e.startTimer}},[e._v("Start Timer")]),s("v-btn",{on:{click:e.reset}},[e._v("Reset")])],1)],1)],1)],1)},pt=[],mt=(s("2b3d"),s("4a9d")),vt=s.n(mt),ft={name:"VideoPlayer",data:function(){return{video:null,progress:0,value:"",custom:!0,src:"",error:!1}},computed:{color:function(){return 100==this.progress?"success":this.error?"error":"primary"}},watch:{video:function(e){console.log(e),this.src=URL.createObjectURL(e)}},methods:{startTimer:function(){var e=this;setInterval((function(){e.progress<100&&(e.progress+=10)}),1e3)},reset:function(){this.progress=0},submit:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return vt.a.config.update({accessKeyId:Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_AWS_ACCESS_KEY,secretAccessKey:Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_AWS_SECRET_ACCESS_KEY}),vt.a.config.region="ap-southeast-1",t.prev=2,s=new vt.a.S3.ManagedUpload({partSize:10485760,params:{Bucket:Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_BUCKET_NAME,Key:"testingmultipart/".concat(e.video.name),Body:e.video}}),s.on("httpUploadProgress",(function(t){e.progress=parseInt(100*t.loaded/t.total)})),t.next=7,s.promise();case 7:console.log(s),t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](2),console.log(t.t0),e.error=!0;case 14:case"end":return t.stop()}}),t,null,[[2,10]])})))()}},mounted:function(){console.log(Object({NODE_ENV:"production",BASE_URL:"/"}))}},gt=ft,bt=(s("0313"),s("23a7")),xt=s("8e36"),wt=Object(h["a"])(gt,ht,pt,!1,null,"4baf1c5f",null),_t=wt.exports;m()(wt,{VBtn:g["a"],VCol:Q["a"],VContainer:ee["a"],VFileInput:bt["a"],VForm:de["a"],VProgressLinear:xt["a"],VRow:re["a"]});var yt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mt-5",attrs:{id:"student"}},[e.user.isTutor?s("panel",{attrs:{title:"My Courses"}},[s("v-list",e._l(e.userOwnedCourses,(function(t,r){return s("v-list-item",{key:t.id,on:{click:function(s){return e.goToThread(s,t)}}},[s("v-list-item-content",[s("v-list-item-title",{staticClass:"text-h5 py-0",domProps:{textContent:e._s(t.name)}})],1),s("v-list-item-icon",[s("div",{staticClass:"notification"},[s("p",{staticClass:"pa-0 mx-auto"},[e._v(e._s(t.unreadStudentPost))])])])],1)})),1)],1):s("panel",{attrs:{title:"Subscribed Courses"}},[s("v-list",e._l(e.userSubscribedCourses,(function(t,r){return s("v-list-item",{key:t.id,on:{click:function(s){return e.showThread(s,t)}}},[s("v-list-item-content",[s("v-list-item-title",{staticClass:"text-h5 py-0",domProps:{textContent:e._s(t.name)}})],1),s("v-list-item-icon",[s("div",{staticClass:"notification"},[s("p",{staticClass:"pa-0 mx-auto"},[e._v(e._s(t.unreadTutorPost))])])])],1)})),1)],1)],1)},kt=[],Ct={name:"CoursesThreadsIndex",data:function(){return{avatar:"https://cdn.vuetifyjs.com/images/lists/2.jpg",threads:[],userOwnedCourses:[],userSubscribedCourses:[]}},computed:Object(l["b"])(["user"]),methods:{goToThread:function(e,t){this.$router.push("/course/threads/index/".concat(t.id))},showThread:function(e,t){this.$router.push({name:"showthread",params:{course_id:t.id,student_id:this.user.id}})}},mounted:function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(){var t,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.user.isStudent){e.next=7;break}return e.next=3,$.getSubscriptionInfoOfStudent(this.user.id);case 3:t=e.sent,this.userSubscribedCourses=t.data.courses,e.next=11;break;case 7:return e.next=9,q.list(this.user.id);case 9:s=e.sent,this.userOwnedCourses=s.data.courses;case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},St=Ct,Vt=(s("46a2"),Object(h["a"])(St,yt,kt,!1,null,"2deef921",null)),Tt=Vt.exports;m()(Vt,{VList:x["a"],VListItem:w["a"],VListItemContent:k["a"],VListItemIcon:y["a"],VListItemTitle:k["b"]});var Nt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"student"}},[s("panel",{attrs:{title:"All Students",md:"8"}},[s("v-list",e._l(e.students,(function(t,r){return s("v-list-item",{key:t.id,on:{click:function(s){return e.showThread(s,t)}}},[s("v-list-item-content",[s("v-list-item-title",{domProps:{textContent:e._s(t.username)}})],1),s("v-list-item-icon",[s("div",{staticClass:"notification"},[s("p",{staticClass:"pa-0 mx-auto"},[e._v(e._s(e.unreads[r]))])])])],1)})),1)],1)],1)},It=[],Pt={name:"CourseThreadsIndex",data:function(){return{students:[],unreads:[]}},computed:Object(c["a"])({},Object(l["b"])(["user"])),methods:{showThread:function(e,t){this.$router.push({name:"showthread",params:{course_id:this.$route.params.course_id,student_id:t.id}})}},mounted:function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(){var t,s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,$.getSubscriptionInfoOfCourse(this.$route.params.course_id);case 2:t=e.sent,this.students=t.data.students,s=0;case 5:if(!(s<this.students.length)){e.next=13;break}return e.next=8,Se.getUnread(this.$route.params.course_id,this.students[s].id);case 8:r=e.sent,this.unreads.push(r.data.unread);case 10:s++,e.next=5;break;case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},Rt=Pt,Et=(s("ad98"),Object(h["a"])(Rt,Nt,It,!1,null,"025b907a",null)),Ot=Et.exports;m()(Et,{VList:x["a"],VListItem:w["a"],VListItemContent:k["a"],VListItemIcon:y["a"],VListItemTitle:k["b"]});var Bt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.course?s("div",{attrs:{id:"student"}},[s("v-container",[s("h1",[e._v(e._s(e.course.name))]),s("v-row",[s("v-col",[s("v-expansion-panels",{staticClass:"elevation-2",attrs:{hover:"",multiple:""},model:{value:e.currentThread,callback:function(t){e.currentThread=t},expression:"currentThread"}},e._l(e.threads,(function(t,r){return s("v-expansion-panel",{key:t.id},[s("v-expansion-panel-header",{staticClass:"font-weight-bold",staticStyle:{"font-size":"18px"}},[e._v(e._s(e.course.lessons[r].name))]),s("v-expansion-panel-content",{staticClass:"px-6"},[t.posts?s("v-list",e._l(t.posts,(function(n,i){return s("v-list-item",{key:n.id},[s("v-list-item-content",{staticClass:"pb-0"},[s("v-container",{staticClass:"pt-0 pb-4 px-0",attrs:{fluid:""}},[0==i||n.updatedAt.substring(0,10)!=t.posts[i-1].updatedAt.substring(0,10)?s("v-row",{staticClass:"py-0"},[s("v-col",{staticClass:"py-0"},[s("v-chip",{staticStyle:{"font-size":"12px"},attrs:{label:"",color:"indigo darken-3",dark:""}},[e._v(e._s(new Date(n.updatedAt).toLocaleString([],{year:"numeric",month:"numeric",day:"numeric"})))])],1)],1):e._e(),n.videoUrl?s("v-row",{staticClass:"mt-5"},[s("v-col",{staticClass:"py-0 text-center",staticStyle:{"margin-bottom":"-3px","background-color":"black"}},[s("video",{staticStyle:{"max-width":"100%","max-height":"400px"},attrs:{controls:""}},[s("source",{attrs:{src:n.videoUrl,type:"video/mp4"}}),e._v("Your browser does not support HTML video.")])])],1):s("v-row",[s("v-col",{staticClass:"pb-0",staticStyle:{"border-bottom":"1px solid #BDBDBD"}})],1),n.UserId!=e.user.id?s("v-row",{staticClass:"justify-end bottom-border mx-0 py-3"},[n.UserId==e.user.id?s("v-col",{staticClass:"py-0 text-left",attrs:{cols:"5"}},[s("v-btn",{attrs:{icon:"",color:"indigo"},on:{click:function(s){return e.deletePost(s,t,r,n)}}},[s("v-icon",[e._v("mdi-trash-can-outline")])],1)],1):e._e(),s("v-col",{staticClass:"pr-8 py-0",attrs:{cols:"6"}},[s("div",{staticClass:"speech-bubble-other"},[s("v-row",{staticClass:"ma-0",staticStyle:{width:"100%"}},[s("v-col",{staticClass:"text-left"},[s("div",[e._v(e._s(n.message))])])],1),s("div",{staticClass:"timestamp"},[e._v(e._s(new Date(n.updatedAt).toLocaleString([],{hour:"2-digit",minute:"2-digit"})))])],1)]),s("v-col",{staticClass:"text-center pa-0",attrs:{cols:"1"}},[s("v-avatar",{attrs:{color:"grey",size:"40"}},[s("v-icon",[e._v("mdi-account")])],1)],1)],1):s("v-row",{staticClass:"justify-start bottom-border mx-0 py-3"},[s("v-col",{staticClass:"text-center pa-0",attrs:{cols:"1"}},[s("v-avatar",{attrs:{color:"grey",size:"40"}},[s("v-icon",[e._v("mdi-account")])],1)],1),s("v-col",{staticClass:"pl-8 py-0",attrs:{cols:"6"}},[s("div",{staticClass:"speech-bubble-self"},[s("v-row",{staticClass:"ma-0",staticStyle:{width:"100%"}},[s("v-col",{staticClass:"text-left"},[s("div",[e._v(e._s(n.message))])])],1),s("div",{staticClass:"timestamp"},[e._v(e._s(new Date(n.updatedAt).toLocaleString([],{hour:"2-digit",minute:"2-digit"})))])],1)]),n.UserId==e.user.id?s("v-col",{staticClass:"py-0 text-right",attrs:{cols:"5"}},[s("v-btn",{attrs:{icon:"",color:"indigo"},on:{click:function(s){return e.deletePost(s,t,r,n)}}},[s("v-icon",[e._v("mdi-trash-can-outline")])],1)],1):e._e()],1)],1)],1)],1)})),1):e._e(),s("v-row",{staticClass:"justify-center"},[s("v-col",{attrs:{cols:"10"}},[s("v-form",{ref:"form-"+t.id,refInFor:!0},[s("v-row",[s("v-col",{attrs:{cols:"12"}},[s("v-textarea",{attrs:{outlined:"",name:"input-7-4",label:"Draft a reply"},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}})],1),s("v-col",{attrs:{cols:"6"}},[s("v-file-input",{attrs:{accept:"video/mp4, video/ogg",placeholder:"Upload","prepend-icon":"mdi-video",label:"Reply Video"},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}})],1),s("v-col",{attrs:{cols:"6"}})],1)],1)],1)],1),s("v-row",[s("v-col",[s("v-btn",{attrs:{large:"",color:"#ec5252",dark:""},on:{click:function(s){return e.create_post(s,t,r)}}},[e._v("Reply your student")])],1)],1)],1)],1)})),1)],1)],1)],1)],1):e._e()},Lt=[],Mt=(s("c975"),s("a434"),{create:function(e){var t=W();return t.defaults.headers.post["Content-Type"]="multipart/form-data",t.post("post/new",e)},list:function(e){return W().get("post/list?tid=".concat(e))},edit:function(e){var t=W();return t.defaults.headers.post["Content-Type"]="multipart/form-data",t.post("post/edit",e)},delete:function(e){return W().delete("post/del?pid=".concat(e))}}),Ut={name:"ShowCourseThread",props:["lesson_pos"],data:function(){return{avatar:"https://cdn.vuetifyjs.com/images/lists/2.jpg",threads:[],course:null,message:"",file:null,grade:0,requiredRules:[function(e){return!!e||"This field is required"}],currentThread:[]}},computed:Object(c["a"])({},Object(l["b"])(["user"])),methods:{adjustAspectRatioForFullScreen:function(e,t){var s=this.originalHeight/this.originalWidth,r=e*s;r>t?(this.videoHeight=t,this.videoWidth=t/s):r==t?(this.videoHeight=t,this.videoWidth=e):(this.videoHeight=r,this.videoWidth=e)},create_post:function(e,t,s){var r=this;return Object(F["a"])(regeneratorRuntime.mark((function e(){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!r.$refs["form-".concat(t.id)][0].validate()){e.next=14;break}return n=new FormData,n.set("tid",t.id),n.set("message",r.message),n.set("grade",r.grade),n.append("video",r.file),e.next=8,Mt.create(n);case 8:i=e.sent,r.threads[s].posts.splice(r.threads[s].posts.length,0,i.data.post),r.file=null,r.message=null,e.next=15;break;case 14:return e.abrupt("return");case 15:case"end":return e.stop()}}),e)})))()},deletePost:function(e,t,s,r){var n=this;return Object(F["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!confirm("Are you sure you want to delete?")){e.next=4;break}return e.next=3,Mt.delete(r.id);case 3:n.threads[s].posts.splice(n.threads[s].posts.indexOf(r),1);case 4:case"end":return e.stop()}}),e)})))()}},mounted:function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(){var t,s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,q.show(this.$route.params.course_id);case 2:t=e.sent,this.course=t.data.course,s=0;case 5:if(!(s<this.course.lessons.length)){e.next=13;break}return e.next=8,Se.show(this.course.lessons[s].id,this.$route.params.student_id);case 8:r=e.sent,this.threads.push(r.data.thread);case 10:s++,e.next=5;break;case 13:this.user.isStudent?this.$store.dispatch("setNotifications",this.$store.state.notifications-this.course.unreadTutorPost):this.$store.dispatch("setNotifications",this.$store.state.notifications-this.course.unreadStudentPost);case 14:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},Ft=Ut,At=(s("6b7d"),s("8212")),Dt=s("cc20"),jt=s("cd55"),$t=s("49e2"),Ht=s("c865"),Wt=s("0393"),qt=s("a844"),Xt=Object(h["a"])(Ft,Bt,Lt,!1,null,"1511ee0e",null),Kt=Xt.exports;m()(Xt,{VAvatar:At["a"],VBtn:g["a"],VChip:Dt["a"],VCol:Q["a"],VContainer:ee["a"],VExpansionPanel:jt["a"],VExpansionPanelContent:$t["a"],VExpansionPanelHeader:Ht["a"],VExpansionPanels:Wt["a"],VFileInput:bt["a"],VForm:de["a"],VIcon:b["a"],VList:x["a"],VListItem:w["a"],VListItemContent:k["a"],VRow:re["a"],VTextarea:qt["a"]});var zt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.course?s("div",[s("v-container",[s("v-row",{staticClass:"justify-center"},[s("v-col",{attrs:{cols:"12",md:"6"}},[s("v-row",{staticClass:"justify-center"},[s("v-col",{staticClass:"px-4"},[s("h2",{staticClass:"font-weight-bold"},[e._v("Checkout")])])],1),s("v-radio-group",{attrs:{mandatory:!0},model:{value:e.paymentMethod,callback:function(t){e.paymentMethod=t},expression:"paymentMethod"}},[s("v-radio",{attrs:{label:"Paypal",value:"paypal"}}),s("v-radio",{attrs:{label:"Credit Card",value:"credit card"}})],1),s("v-row",{staticClass:"justify-center",class:{hide:"paypal"==e.paymentMethod}},[s("v-col",{staticClass:"px-4"},[s("div",{attrs:{id:"dropin-container"}})])],1),s("v-row",[s("v-col",[s("v-card",{staticClass:"pa-3 px-10",attrs:{outlined:""}},[s("v-row",{staticClass:"px-3"},[s("v-col",[s("h2",{staticClass:"font-weight-bold"},[e._v("Summary")])])],1),s("v-row",{staticClass:"px-3"},[s("v-col",{staticClass:"px-4",attrs:{cols:"12"}},[s("p",{staticClass:"alignleft"},[e._v(e._s(e.course.name)+":")]),s("p",{staticClass:"alignright"},[e._v("S$ "+e._s(e.course.price))])]),s("v-col",{staticClass:"px-4",attrs:{cols:"12"}},[s("p",{staticClass:"alignleft"},[e._v("GST:")]),s("p",{staticClass:"alignright"},[e._v("S$ "+e._s((.07*e.course.price).toFixed(2)))]),s("div",{staticStyle:{clear:"both"}})])],1),s("v-divider",{staticClass:"px-3"}),s("v-row",{staticClass:"px-3"},[s("v-col",[s("p",{staticClass:"alignleft font-weight-bold"},[e._v("Total:")]),s("p",{staticClass:"alignright font-weight-bold"},[e._v("S$ "+e._s((e.course.price+.07*e.course.price).toFixed(2)))]),s("div",{staticStyle:{clear:"both"}})])],1),s("v-btn",{staticClass:"mb-5",class:{hide:"paypal"==e.paymentMethod},staticStyle:{width:"50%"},attrs:{large:"",color:"#ec5252",dark:""},on:{click:e.requestPaymentMethod}},[e._v("Complete Payment")]),s("v-row",{staticClass:"justify-center",class:{hide:"paypal"!=e.paymentMethod}},[s("v-col",[s("div",{attrs:{id:"paypal-button-container"}})])],1),s("div",{staticClass:"error",model:{value:e.error,callback:function(t){e.error=t},expression:"error"}},[e._v(e._s(e.error))])],1)],1)],1)],1)],1)],1)],1):e._e()},Yt=[],Gt=(s("b680"),{getClientToken:function(){return W().get("braintree-client-token")},createTransaction:function(e){return W().post("braintree-checkout",e)},createPaypalTransaction:function(e){return W().post("braintree-paypal-checkout",e)},getPaypalClientToken:function(){return W().get("paypal-client-token")},createOrder:function(e){return W().post("paypal-create-order",e)},captureOrder:function(e){return W().post("paypal-capture-order",e)}}),Zt={name:"Payment",data:function(){return{course:null,clientToken:"",dropinInstance:null,nonceObj:null,deviceData:null,transaction:null,error:null,paymentMethod:"paypal"}},methods:{togglePaymentMethod:function(){"paypal"==this.paymentMethod?this.paymentMethod="credit card":this.paymentMethod="paypal"},requestPaymentMethod:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.dropinInstance.requestPaymentMethod();case 2:return e.nonceObj=t.sent,t.next=5,Gt.createTransaction({amount:e.course.price,nonce:e.nonceObj.nonce,deviceData:e.deviceData});case 5:e.transaction=t.sent.data.result,e.transaction.success?e.subscribe():e.error=e.transaction.message;case 7:case"end":return t.stop()}}),t)})))()},subscribe:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(e.course.lessons.map(function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(t){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Se.create({lid:t.id});case 2:return s=e.sent,s.data.thread.posts=[],t.thread=s.data.thread,e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return t.next=4,e.$store.dispatch("subscribe",{studentId:e.$store.state.user.id,courseId:e.course.id});case 4:e.$router.push("/course/show/".concat(e.course.id));case 5:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(){var t,s,r,n,i,o,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,q.show(this.$route.params.course_id);case 2:return t=e.sent,this.course=t.data.course,e.next=6,Gt.getClientToken();case 6:return s=e.sent.data.clientToken,this.clientToken=s,e.next=10,window.braintree.dropin.create({authorization:s,container:"#dropin-container"});case 10:return r=e.sent,this.dropinInstance=r,e.next=14,window.braintree.client.create({authorization:s});case 14:return n=e.sent,e.next=17,window.braintree.dataCollector.create({client:n,paypal:!0});case 17:i=e.sent,this.deviceData=i.deviceData,o=document.createElement("script"),o.src="https://www.paypal.com/sdk/js?client-id=AepgsiQK_rhw-m-bTjjuZ5lRxPWadsmSzn9dH_Lsn8o5uzSsTHsIRuxfaCfyg0odhrZFxq6_qpsmu-P7&currency=SGD",o.addEventListener("load",(function(){window.paypal.Buttons({locale:"en_US",createOrder:function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Gt.createOrder({amount:(a.course.price+.07*a.course.price).toFixed(2)});case 2:return t=e.sent.data.order.id,a.orderId=t,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),onApprove:function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Gt.captureOrder({orderId:a.orderId});case 2:t=e.sent.data.result,a.result=t,"COMPLETED"==a.result.status&&(alert("Success!"),a.subscribe());case 5:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),onError:function(e){console.log(e)}}).render("#paypal-button-container");var e=document.createElement("script");e.src="https://www.paypalobjects.com/js/external/connect/api.js",e.addEventListener("load",(function(){window.paypal.use(["login"],(function(e){e.render({appid:"AepgsiQK_rhw-m-bTjjuZ5lRxPWadsmSzn9dH_Lsn8o5uzSsTHsIRuxfaCfyg0odhrZFxq6_qpsmu-P7",authend:"sandbox",scopes:"openid",containerid:"connect-button",responseType:"code",locale:"en-us",buttonShape:"rectangle",buttonSize:"lg",returnurl:"https://example.com"})}))})),document.body.appendChild(e)})),document.body.appendChild(o);case 23:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},Jt=Zt,Qt=(s("0a62"),Object(h["a"])(Jt,zt,Yt,!1,null,"36c8210a",null)),es=Qt.exports;m()(Qt,{VBtn:g["a"],VCard:Z["a"],VCol:Q["a"],VContainer:ee["a"],VDivider:te["a"],VRadio:he["a"],VRadioGroup:pe["a"],VRow:re["a"]});var ts=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"score"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.scoreLoading,expression:"!scoreLoading"}],ref:"scorediv",staticClass:"ma-0",staticStyle:{height:"220px",width:"1000px"},attrs:{id:"score"}}),s("v-btn",{on:{click:e.changeBars}},[e._v("Change Bars")])],1)},ss=[],rs=s("2938"),ns={name:"OSMD",data:function(){return{scoreLoading:!1,osmd:null,from:1,to:2}},methods:{changeBars:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.from+=2,e.to+=2,e.osmd.setOptions({drawFromMeasureNumber:e.from,drawUpToMeasureNumber:e.to}),console.log(e.osmd.graphic),t.next=6,e.osmd.render();case 6:console.log(e.osmd.graphic);case 7:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return rs["OpenSheetMusicDisplay"].prototype.preCalculate=function(){if(!this.graphic)throw new Error("OpenSheetMusicDisplay: Before rendering a music sheet, please load a MusicXML file");this.drawer&&this.drawer.clear();var e=this.container.offsetWidth;this.rules.RenderSingleHorizontalStaffline&&(e=32767),console.log("[OSMD] render width: "+e),this.sheet.pageWidth=e/this.zoom/10,this.rules.PageFormat&&!this.rules.PageFormat.IsUndefined?(this.rules.PageHeight=this.sheet.pageWidth/this.rules.PageFormat.aspectRatio,console.log("[OSMD] PageHeight: "+this.rules.PageHeight)):(console.log("[OSMD] endless/undefined pageformat, id: "+this.rules.PageFormat.idString),this.rules.PageHeight=100001),this.graphic.reCalculate(),this.drawingParameters.drawCursors&&(this.graphic.Cursors.length=0),this.createOrRefreshRenderBackend(),this.needBackendUpdate=!1,this.drawer.setZoom(this.zoom),this.drawer.drawSheet(this.graphic),this.enableOrDisableCursor(this.drawingParameters.drawCursors),this.drawingParameters.drawCursors&&this.cursor&&this.cursor.update(),this.zoomUpdated=!1},this.osmd=new rs["OpenSheetMusicDisplay"](this.$refs.scorediv,{drawFromMeasureNumber:1,drawUpToMeasureNumber:2,fillEmptyMeasuresWithWholeRest:!0,drawComposer:!1,drawTitle:!1,renderSingleHorizontalStaffline:!0,drawPartNames:!1,autoResize:!1,drawMetronomeMarks:!1,drawingParameters:"compacttight"}),this.scoreLoading=!0,t="https://rhythm-academy.s3-ap-southeast-1.amazonaws.com/twinkle-twinkle-little-star.musicxml",e.next=6,this.osmd.load(t);case 6:return this.scoreLoading=!1,e.next=9,this.$nextTick();case 9:return console.log(this.osmd.graphic),e.next=12,this.osmd.render();case 12:console.log(this.osmd.graphic);case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},is=ns,os=Object(h["a"])(is,ts,ss,!1,null,null,null),as=os.exports;m()(os,{VBtn:g["a"]});var cs=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.course&&e.lesson?r("div",[r("v-container",{staticClass:"pa-0",attrs:{fluid:""}},[r("v-row",{attrs:{"no-gutters":""}},[r("v-col",{staticClass:"text-left pa-0",attrs:{cols:"9"}},[r("v-row",{staticClass:"ma-0",staticStyle:{width:"100%"}},[r("v-col",{staticClass:"pa-0",attrs:{id:"title"}},[r("h1",{staticClass:"font-weight-bold pl-8 py-2"},[e._v(e._s(e.course.name))])])],1),r("v-row",{staticClass:"ma-0",staticStyle:{width:"100%"}},[r("v-col",{staticClass:"pa-0"},[e.isVideoContent?r("video-player",{attrs:{exercise:this.lesson.exercises[0],videoSrc:e.src}}):e._e()],1)],1),r("v-container",[r("v-tabs",{attrs:{color:"indigo"},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[r("v-tabs-slider"),r("v-tab",{attrs:{href:"#feedback"}},[e._v("Auto Feedback")]),r("v-tab-item",{attrs:{value:"feedback"}},[r("v-card",{attrs:{flat:"",tile:""}},[r("v-container",[r("v-row",[r("v-col",[r("h1",[e._v("Submit your practice audio to get feedback!")])])],1),r("v-row",[r("v-col",{attrs:{cols:"6"}},[r("v-file-input",{attrs:{label:"Upload audio...",outlined:"",color:"indigo",dense:""},model:{value:e.newAudio,callback:function(t){e.newAudio=t},expression:"newAudio"}})],1),r("v-col",{attrs:{cols:"6"}},[r("v-btn",{staticStyle:{"margin-top":"2px"},attrs:{color:"#ec5252",dark:""},on:{click:function(t){return e.submitAudio()}}},[e._v("Submit")])],1)],1),r("v-row",[r("v-col",[r("v-menu",{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on,n=t.attrs;return[r("v-btn",e._g(e._b({attrs:{light:""}},"v-btn",n,!1),s),[e._v("Past Submissions"),r("v-icon",{attrs:{right:"",dark:""}},[e._v("mdi-menu-down")])],1)]}}],null,!1,160124499)},[r("v-list",e._l(e.recordings,(function(t,s){return r("v-list-item",{key:s,on:{click:function(s){e.transcribedNotes=e.splitFeedbackIntoRows(JSON.parse(t.transcription))}}},[r("v-list-item-title",[e._v(e._s(t.audioFilename))])],1)})),1)],1)],1)],1),r("v-row",{staticClass:"justify-center"},[r("v-col",{staticClass:"py-0",attrs:{cols:"12"}},e._l(e.scoreParts,(function(t,s){return r("div",{key:s},[r("div",{staticStyle:{position:"relative"},attrs:{id:"vexflow-wrapper-"+s}}),e.transcribedNotes.length>0?r("line-graph",{attrs:{transcribedNotes:e.transcribedNotes[s],rowNum:s+1,bpm:e.currEx.bpm}}):e._e()],1)})),0)],1),r("v-row",[r("v-col",[r("v-btn",{on:{click:e.playTutorAudio}},[e._v("Play")]),r("v-btn",{on:{click:e.pauseTutorAudio}},[e._v("Pause")]),r("v-btn",{on:{click:function(t){e.transform=0}}},[e._v("reset")])],1),r("img",{staticStyle:{position:"absolute",top:"0",opacity:"0.7",transition:"8s transform linear"},style:{transform:"translateX("+e.transform+"px)",left:e.left+"px",transition:e.transitionTime+"s transform linear"},attrs:{src:s("2bd4"),id:"tick"}})],1)],1)],1)],1)],1)],1)],1),r("v-col",{staticClass:"pa-0",class:{"full-height":e.fullHeight,"partial-height":!e.fullHeight},staticStyle:{"border-bottom":"1px solid #BDBDBD","border-left":"1px solid #BDBDBD",position:"fixed",right:"0"},attrs:{cols:"3"}},[r("h1",{staticClass:"font-weight-bold pl-4 py-2",staticStyle:{"background-color":"#EEEEEE"}},[e._v("Lessons")]),r("v-list",{staticClass:"py-0"},e._l(e.course.lessons,(function(t,s){return r("v-list-item",{key:s,staticClass:"px-0"},[t==e.lesson&&e.lesson.exercises.length>1?r("v-expansion-panels",{staticClass:"px-0",attrs:{accordion:"",flat:"",hover:"",tile:"",dense:"",multiple:""},model:{value:e.opened,callback:function(t){e.opened=t},expression:"opened"}},[r("v-expansion-panel",[r("v-expansion-panel-header",{staticClass:"py-0 pl-4 pr-2",staticStyle:{"font-size":"16px","background-color":"#C5CAE9"}},[e._v(e._s(s+1)+". "+e._s(t.name))]),r("v-expansion-panel-content",{staticClass:"pa-0"},[r("v-list",{staticClass:"py-0"},[r("v-list-item-group",{staticClass:"py-0"},e._l(t.exercises,(function(t,s){return r("v-list-item",{key:s,staticClass:"px-0",on:{click:function(s){e.src=t.videoUrl}}},[r("v-list-item-content",[r("div",{staticClass:"pl-4 text-decoration-underline",staticStyle:{"font-size":"14px",color:"#291957"}},[e._v(e._s(t.name))])])],1)})),1)],1)],1)],1)],1):t==e.lesson&&1==e.lesson.exercises.length?r("v-list-item-content",{staticClass:"py-0 link"},[r("a",{staticClass:"link pl-4 py-5",staticStyle:{"font-size":"16px","background-color":"#C5CAE9"}},[e._v(e._s(s+1)+". "+e._s(t.name))])]):t!=e.lesson?r("v-list-item-content",{staticClass:"py-0 link"},[r("a",{staticClass:"link pl-4 py-5",staticStyle:{"font-size":"16px"},on:{click:function(s){return e.goToLesson(s,t)}}},[e._v(e._s(s+1)+". "+e._s(t.name))])]):e._e()],1)})),1)],1)],1)],1),r("audio",{ref:"tutorAudio",on:{timeupdate:e.tutorAudioTimeUpdate}},[r("source",{attrs:{src:"http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",type:"audio/ogg"}}),e._v("Your browser does not support the audio tag.")])],1):e._e()},ls=[],us=(s("4de4"),s("7db0"),s("0481"),s("fb6a"),s("4069"),s("1276"),s("2909")),ds=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",e._l(e.graphs,(function(e){return s("Plotly",{attrs:{data:e.data,layout:e.layout,"display-mode-bar":!1,"static-plot":!0,responsive:!0}})})),1)},hs=[],ps=s("04d1"),ms={name:"LineGraph",components:{Plotly:ps["Plotly"]},props:["transcribedNotes","rowNum","bpm"],watch:{transcribedNotes:function(e){console.log(e),this.graphs=this.getGraphsForNotes(e)}},data:function(){return{minNoteNumber:"C3",maxNoteNumber:"C6",timeSignature:4,barsPerRow:4,secondsPerRow:0,graphs:[]}},methods:{getSecondsPerRow:function(){return 60/this.bpm*this.timeSignature*this.barsPerRow},getNumberFromMusicNote:function(e){var t=0;t=e.length>2?e[e.length-1]-"0":e[1]-"0";var s=e[0].charCodeAt(0)-"C".charCodeAt(0);return s<0&&(s+=8),8*t+s},getLineSegmentForMusicNote:function(e){var t=this.getLineSegmentYValForMusicNote(e);return{type:"line",x0:e.onset,y0:t,x1:e.onset+e.duration,y1:t,line:{color:"rgb(55, 128, 191)",width:3}}},getLineSegmentYValForMusicNote:function(e){var t=this.getNumberFromMusicNote(this.minNoteNumber),s=this.getNumberFromMusicNote(this.maxNoteNumber),r=this.getNumberFromMusicNote(e.note);return(r-t)/(s-t)*(this.maxNoteNumber[1]-this.minNoteNumber[1])},splitIntoRows:function(e){var t=this.getSecondsPerRow(),s=0,r=[];r.push([]);for(var n=0;n<e.length;n++){var i=e[n];if(i.onset<s+t)if(i.onset+i.duration<=s+t)r[r.length-1].push(i);else{var o=Object(c["a"])({},i);o.onset=s+t,o.duration=i.onset+i.duration-(s+t),i.duration=i.duration-o.duration,r[r.length-1].push(i),e[n]=o,s+=t,r.push([]),n--}else s+=t,r.push([]),n--}return r},getTickValsForRow:function(e){for(var t=this,s=[],r=0;r<=this.barsPerRow*this.timeSignature;r++)s.push(r);return s.map((function(s){return s+e*t.barsPerRow*t.timeSignature}))},getAnnotationXValsForNotes:function(e){return e.map((function(e){return e.onset+e.duration/2}))},getAnnotationYValsForNotes:function(e){var t=this;return e.map((function(e){var s=t.getLineSegmentYValForMusicNote(e)+.3;return s<=t.maxNoteNumber[1]-t.minNoteNumber[1]?s:s-.7}))},getAnnotationsForNotes:function(e){return e.map((function(e){return e.note}))},getBarDividers:function(e){for(var t=0,s=this.maxNoteNumber[1]-this.minNoteNumber[1],r=[],n=1;n<=this.barsPerRow;n++){var i=n*this.timeSignature+e*this.timeSignature*this.barsPerRow,o={type:"line",x0:i,y0:t,x1:i,y1:s,line:{color:"#bdbdbd",width:2}};r.push(o)}return r},getGraphsForNotes:function(e){for(var t=this,s=this.splitIntoRows(e),r=[],n=0;n<s.length;n++){var i=s[n],o={data:[{x:this.getAnnotationXValsForNotes(i),y:this.getAnnotationYValsForNotes(i),text:this.getAnnotationsForNotes(i),mode:"text"}],layout:{xaxis:{zeroline:!1,range:[n*this.secondsPerRow,(n+1)*this.secondsPerRow+.1],tickvals:this.getTickValsForRow(n),tickfont:{family:"Old Standard TT, serif",size:10,color:"Brown"}},yaxis:{range:[0,3.1],tickvals:[0,1,2,3],ticktext:["C3","C4","C5","C6"],tickfont:{family:"Old Standard TT, serif",size:10,color:"Brown"}},height:150,margin:{l:30,r:20,b:20,t:20,pad:8},shapes:i.map((function(e){return t.getLineSegmentForMusicNote(e)})).concat(this.getBarDividers(n))}};r.push(o)}return r}},mounted:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.secondsPerRow=e.getSecondsPerRow(),e.transcribedNotes.length>0&&(e.graphs=e.getGraphsForNotes(e.transcribedNotes));case 2:case"end":return t.stop()}}),t)})))()}},vs=ms,fs=Object(h["a"])(vs,ds,hs,!1,null,"579c7cad",null),gs=fs.exports,bs=(s("a15b"),s("f0e2")),xs=(s("6922"),{list:function(e){return W().get("file/list?lid=".concat(e))},create:function(e){return W().post("file/new",e)},delete:function(e){return W().delete("file/del?fid=".concat(e))}}),ws=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{"font-size":"14px !important"}},[s("video",{ref:"videoPlayer",staticClass:"vjs-big-play-centered video-js",attrs:{id:"video"}}),s("v-row",{directives:[{name:"show",rawName:"v-show",value:!e.hide,expression:"!hide"}],staticClass:"bpm-control pt-2",attrs:{id:"slider"}},[s("v-icon",{attrs:{color:"white",large:""}},[e._v("$vuetify.icons.custom_bpm")]),s("v-slider",{staticClass:"pb-2",attrs:{min:"20",max:"180",vertical:"",color:"white","track-color":"rgba(115, 133, 159, 0.5)","thumb-label":"always"},model:{value:e.playbackBpm,callback:function(t){e.playbackBpm=t},expression:"playbackBpm"}})],1)],1)},_s=[],ys={name:"VideoPlayer",props:["exercise","videoSrc"],data:function(){return{numberOfBars:null,bpm:null,timeSignature:null,description:"",melody:[],useScore:!1,useXml:!1,notesInBars:null,playbackBpm:0,videoHandler:null,player:null,hide:!0,timePerTwoBars:0,timePerBar:0,demoStartTime:0,demoEndTime:null,currentDisplayedBar:0,videoOsmd:null,from:1,to:2}},methods:{timeUpdated:function(){var e=this.player.currentTime(),t=e-this.demoStartTime,s=Math.floor(t/this.timePerTwoBars);s!=this.currentDisplayedBar&&(s>=0&&s<Math.floor(this.numberOfBars/2)?(this.currentDisplayedBar=s,this.videoHandler.importNotes(this.notesInBars[2*s].concat(this.notesInBars[2*s+1]),this.timeSignature)):s<0&&0!=this.currentDisplayedBar?(this.currentDisplayedBar=0,this.videoHandler.importNotes(this.notesInBars[0].concat(this.notesInBars[1]),this.timeSignature)):s>Math.floor(this.numberOfBars/2)&&(this.numberOfBars<2?(this.currentDisplayedBar=0,this.videoHandler.importNotes(this.notesInBars[0].concat(this.notesInBars[1]),this.timeSignature)):(this.currentDisplayedBar=Math.floor(this.numberOfBars/2),this.videoHandler.importNotes(this.notesInBars[this.numberOfBars-1].concat(this.notesInBars[this.numberOfBars-1]),this.timeSignature))))},timeUpdatedOsmd:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){var s,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s=e.player.currentTime(),r=s-e.demoStartTime,n=Math.floor(r/e.timePerTwoBars),n==e.currentDisplayedBar){t.next=25;break}if(!(n>=0&&n<Math.floor(e.numberOfBars/2))){t.next=12;break}return console.log(n),e.videoOsmd.setOptions({drawFromMeasureNumber:2*n+1,drawUpToMeasureNumber:2*n+2}),e.currentDisplayedBar=n,t.next=10,e.videoOsmd.render();case 10:t.next=25;break;case 12:if(!(n<0&&0!=e.currentDisplayedBar)){t.next=20;break}return console.log(n),e.videoOsmd.setOptions({drawFromMeasureNumber:1,drawUpToMeasureNumber:2}),e.currentDisplayedBar=0,t.next=18,e.videoOsmd.render();case 18:t.next=25;break;case 20:if(!(n>Math.floor(e.numberOfBars/2))){t.next=25;break}return console.log(n,"from third clause"),e.numberOfBars<2?(e.videoOsmd.setOptions({drawFromMeasureNumber:0,drawUpToMeasureNumber:0}),e.currentDisplayedBar=0):(e.videoOsmd.setOptions({drawFromMeasureNumber:e.numberOfBars-1,drawUpToMeasureNumber:e.numberOfBars}),e.currentDisplayedBar=Math.floor((s-e.demoStartTime)/e.timePerTwoBars)),t.next=25,e.videoOsmd.render();case 25:case"end":return t.stop()}}),t)})))()},drawOsmdScores:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){var s,r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=document.createElement("div"),s.setAttribute("id","video-overlay-background"),s.style.position="absolute",s.style.background="#FAFAFA",s.style.top="0",s.style.left="0",s.style.right="0",s.style.height="130px",s.style.overflow="hidden",r=document.createElement("div"),r.setAttribute("id","video-osmd-wrapper"),r.style.position="absolute",r.style.background="#FAFAFA",r.style.top="0",r.style.left="0",r.style.right="0",n=document.createElement("div"),s.appendChild(r),r.appendChild(n),document.getElementById("video").appendChild(s),e.videoOsmd=new rs["OpenSheetMusicDisplay"](n,{drawFromMeasureNumber:e.from,drawUpToMeasureNumber:e.to,drawComposer:!1,drawTitle:!1,renderSingleHorizontalStaffline:!0,drawPartNames:!1,autoResize:!1,drawMetronomeMarks:!1,backend:"Canvas",drawingParameters:"compacttight"}),t.next=23,e.videoOsmd.load(e.exercise.musicXmlUrl);case 23:return t.next=25,e.$nextTick();case 25:return e.videoOsmd.zoom=1.2,t.next=28,e.videoOsmd.render();case 28:console.log(e.videoOsmd.graphic),console.log(e.videoOsmd.graphic.music);case 30:case"end":return t.stop()}}),t)})))()},drawScores:function(){var e=document.createElement("div");e.setAttribute("id","video-vexflow-wrapper"),e.style.position="absolute",e.style.background="#FAFAFA",e.style.top="0",e.style.left="0",e.style.right="0",this.videoHandler=new et["a"].Handler("video-vexflow-wrapper",{canEdit:!1,numberOfStaves:2,lessStaveHeight:!0,canvasProperties:{id:"video-vexflow-wrapper-canvas",width:this.$refs.videoPlayer.offsetWidth,height:80*et["a"].scale,tabindex:1}},e).init(),this.notesInBars=et["a"].notesToBars(this.melody,this.timeSignature),this.videoHandler.importNotes(this.notesInBars[0].concat(this.notesInBars[1]),this.timeSignature),document.getElementById("video").appendChild(e)}},watch:{playbackBpm:function(e){this.bpm&&this.player.playbackRate(e/this.bpm)},videoSrc:function(e){this.player.src(e)}},mounted:function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(){var t,s,r,n,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t="",t=this.exercise.videoUrl||this.exercise.demoUrl?this.exercise.videoUrl?this.exercise.videoUrl:this.exercise.demoUrl:"undefined",s=Object(bs["default"])(this.$refs.videoPlayer,{controls:!0,aspectRatio:"16:9",sources:[{src:t,type:"video/mp4"}],playbackRates:[.8,.9,1,1.1,1.2],poster:this.exercise.demoPosterUrl?this.exercise.demoPosterUrl:null},(function(){s.hotkeys({volumeStep:.1,seekStep:2,enableModifiersForNumbers:!1,enableHoverScroll:!0}),i.exercise.useScore&&(s.on("userinactive",(function(){s.paused()?i.hide=!1:i.hide=!0})),s.on("useractive",(function(){i.hide=!1})),s.on("play",(function(){i.hide=!1})),s.on("firstplay",(function(){i.hide=!1})),s.on("ratechange",(function(){i.playbackBpm=i.bpm*i.player.playbackRate()})),i.exercise.useXml?s.on("timeupdate",(function(e){i.timeUpdatedOsmd(e)})):s.on("timeupdate",(function(e){i.timeUpdated(e)})))})),this.player=s,r=this.exercise,!r.useScore){e.next=30;break}if(this.useScore=r.useScore,this.useXml=r.useXml,this.bpm=parseInt(r.bpm),this.playbackBpm=this.bpm,this.demoStartTime=r.demoStartTime,!r.useXml){e.next=19;break}return e.next=14,this.drawOsmdScores();case 14:n=this.videoOsmd.sheet.sourceMeasures[0].activeTimeSignature,this.timeSignature="".concat(n.numerator,"/").concat(n.denominator),this.numberOfBars=this.videoOsmd.sheet.sourceMeasures.length,e.next=23;break;case 19:this.melody=r.melody.split("-"),this.timeSignature=r.timeSignature,this.numberOfBars=parseInt(r.numberOfBars),this.drawScores();case 23:this.timePerBar=parseInt(this.timeSignature.split("/")[0])/this.bpm*60,this.timePerTwoBars=2*this.timePerBar,this.demoEndTime=this.demoStartTime+this.timePerBar*this.numberOfBars,document.getElementById("video").appendChild(document.getElementById("slider")),document.getElementsByClassName("v-slider__track-container")[0].style.width="5px",document.getElementsByClassName("v-slider__thumb-label")[0].style.color="black",document.getElementsByClassName("v-slider__thumb-label")[0].style.boxShadow="0px 0px 5px black";case 30:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},ks=ys,Cs=(s("9e85"),s("ba0d")),Ss=Object(h["a"])(ks,ws,_s,!1,null,"04d8e266",null),Vs=Ss.exports;m()(Ss,{VIcon:b["a"],VRow:re["a"],VSlider:Cs["a"]});var Ts={create:function(e){return W().post("recording/new",e)},list:function(e){return W().get("recording/list?eid=".concat(e))},getFeedback:function(e){return W().get("recording/get-notes?rid=".concat(e))},delete:function(e){return W().delete("recording/del?rid=".concat(e))}},Ns={name:"ShowLesson",components:{"video-player":Vs,"line-graph":gs},data:function(){return{course:null,lesson:null,currEx:null,notesInBars:[],handlers:[],scoreParts:[],startEndPosOfRows:[],newAudio:null,transform:0,activeRow:0,left:0,transitionTime:2,moving:!1,playing:!1,recordings:[],thread:null,dialog:!1,requiredRules:[function(e){return!!e||"This field is required"}],message:null,file:null,grade:null,avatar:"https://cdn.vuetifyjs.com/images/lists/2.jpg",error:null,isVideoContent:!0,osmd:null,videoOsmd:null,from:1,to:2,selected:null,fullHeight:!1,opened:[0],src:"",tab:null,transcribedNotes:[]}},watch:{bpm:function(e){this.bpm_label="BPM: "+e},no_bars:function(e){this.bars_label="No. Bars: "+e},"$route.params.lesson_id":function(e){this.$router.go()}},computed:Object(c["a"])({},Object(l["b"])(["user","students","subscribedTutors"])),methods:{goToLesson:function(e,t){this.$router.push({name:"showlesson",params:{course_id:this.course.id,lesson_id:t.id,course:this.course,lesson:t}})},submitAudio:function(e){var t=this;return Object(F["a"])(regeneratorRuntime.mark((function e(){var s,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.newAudio){e.next=13;break}return s=new FormData,s.set("eid",t.currEx.id),s.append("audio",t.newAudio),e.next=6,Ts.create(s);case 6:return r=e.sent.data.recording,e.next=9,Ts.getFeedback(r.id);case 9:n=e.sent.data.recording.transcription,t.transcribedNotes=t.splitFeedbackIntoRows(JSON.parse(n)),e.next=14;break;case 13:alert("Please input an audio file to gain feedback");case 14:case"end":return e.stop()}}),e)})))()},getPastFeedback:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ts.list(e.currEx.id);case 2:s=t.sent.data.recordings,e.recordings=s;case 4:case"end":return t.stop()}}),t)})))()},playTutorAudio:function(){this.$refs["tutorAudio"].play(),this.transform=this.startEndPosOfRows[this.activeRow][1]-this.startEndPosOfRows[this.activeRow][0],this.moving=!0,this.playing=!0},pauseTutorAudio:function(){this.$refs["tutorAudio"].pause();var e=document.getElementById("tick"),t=window.getComputedStyle(e).transform,s=t.slice(7,-1).split(",");this.transform=parseFloat(s[s.length-2]),this.moving=!1,this.playing=!1},tutorAudioTimeUpdate:function(e){if(!this.moving&&this.playing&&(this.transform=this.startEndPosOfRows[this.activeRow][1]-this.startEndPosOfRows[this.activeRow][0],this.transitionTime=60/this.currEx.bpm*parseInt(this.currEx.timeSignature.split("/")[0])*this.handlers[this.activeRow].getNotePositions().filter((function(e){return e.length>0})).length),e.target.currentTime/this.transitionTime>this.activeRow+1&&(this.activeRow++,this.activeRow<this.handlers.length)){this.left=this.startEndPosOfRows[this.activeRow][0],this.transitionTime=0,this.transform=0;var t=document.getElementById("tick");t.parentNode.removeChild(t);var s=document.getElementById("vexflow-wrapper-".concat(this.activeRow));s.appendChild(t),this.moving=!1}},splitFeedbackIntoRows:function(e){for(var t=[],s=[],r=60/this.currEx.bpm*parseInt(this.currEx.timeSignature[0])*4,n=0,i=0;i<e.length;i++)(e[i].onset+e[i].duration)/r<n+1?s.push(e[i]):(t.push(Object(us["a"])(s)),s=[],s.push(e[i]),n++);return s.length>0&&t.push(s),t}},created:function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(){var t,s,r,n,i,o,a,c=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.course&&this.lesson){e.next=18;break}return e.next=3,q.show(this.$route.params.course_id);case 3:return t=e.sent,e.prev=4,e.next=7,Promise.all(t.data.course.lessons.map(function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(s){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=null,c.$store.dispatch("setNotifications",c.$store.state.notifications-t.data.course.unreadTutorPost),e.next=4,Se.show(s.id,c.user.id);case 4:return r=e.sent,s.thread=r.data.thread,e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 7:t.data.course.lessons=e.sent,this.course=t.data.course,e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](4),console.log(e.t0);case 14:return this.lesson=this.course.lessons.find((function(e){return e.id==c.$route.params.lesson_id})),e.next=17,xs.list(this.lesson.id);case 17:this.lesson.files=e.sent.data.files;case 18:if(this.selected=this.course.lessons.indexOf(this.lesson),this.src=this.lesson.exercises[0].videoUrl,this.currEx=this.lesson.exercises[0],window.addEventListener("scroll",(function(){0==window.pageYOffset?c.fullHeight=!1:window.pageYOffset>64&&(c.fullHeight=!0)})),!this.currEx.useScore){e.next=37;break}for(this.currEx.melody=this.currEx.melody.split("-"),this.notesInBars=et["a"].notesToBars(this.currEx.melody,this.currEx.timeSignature),s=0;s<this.notesInBars.length;s+=4)this.scoreParts.push(this.notesInBars.slice(s,s+4).flat());return e.next=28,this.$nextTick();case 28:for(r=document.getElementById("vexflow-wrapper-".concat(0)),n=r.offsetWidth,i=0;i<this.scoreParts.length;i++)this.handlers.push(new et["a"].Handler("vexflow-wrapper-".concat(i),{numberOfStaves:4,stavesPerRow:4,canEdit:!1,canvasProperties:{width:n}}).init()),this.handlers[i].importNotes(this.scoreParts[i],this.currEx.timeSignature),o=this.handlers[i].getNotePositions().filter((function(e){return e.length>0})),this.startEndPosOfRows.push([o[0][0].x,o[o.length-1][o[o.length-1].length-1].x]);this.left=this.startEndPosOfRows[0][0],this.transitionTime=60/this.currEx.bpm*parseInt(this.currEx.timeSignature.split("/")[0])*this.handlers[this.activeRow].getNotePositions().filter((function(e){return e.length>0})).length,a=document.getElementById("tick"),a.parentNode.removeChild(a),r.appendChild(a),this.getPastFeedback();case 37:case"end":return e.stop()}}),e,this,[[4,11]])})));function t(){return e.apply(this,arguments)}return t}(),beforeDestroy:function(){this.player&&this.player.dispose()}},Is=Ns,Ps=(s("1867"),s("e449")),Rs=s("71a3"),Es=s("c671"),Os=s("fe57"),Bs=s("9a96"),Ls=Object(h["a"])(Is,cs,ls,!1,null,"2e2daeb8",null),Ms=Ls.exports;m()(Ls,{VBtn:g["a"],VCard:Z["a"],VCol:Q["a"],VContainer:ee["a"],VExpansionPanel:jt["a"],VExpansionPanelContent:$t["a"],VExpansionPanelHeader:Ht["a"],VExpansionPanels:Wt["a"],VFileInput:bt["a"],VIcon:b["a"],VList:x["a"],VListItem:w["a"],VListItemContent:k["a"],VListItemGroup:_["a"],VListItemTitle:k["b"],VMenu:Ps["a"],VRow:re["a"],VTab:Rs["a"],VTabItem:Es["a"],VTabs:Os["a"],VTabsSlider:Bs["a"]});var Us=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.course?s("v-container",[s("v-row",{staticClass:"justify-center"},[s("v-col",{attrs:{cols:"12"}},[s("v-card",{staticClass:"text-left mb-12",attrs:{outlined:""}},[s("v-card-title",{staticClass:"display-1 px-10"},[e._v("Course Info")]),s("v-divider"),s("v-card-text",{staticClass:"px-10"},[s("v-form",{ref:"courseForm"},[s("v-row",[s("v-col",{attrs:{cols:"12",md:"4"}},[s("v-text-field",{attrs:{label:"Title*",name:"title",type:"text",outlined:"",color:"indigo"},model:{value:e.newCourse.name,callback:function(t){e.$set(e.newCourse,"name",t)},expression:"newCourse.name"}})],1),s("v-col",{attrs:{cols:"12",md:"4"}},[s("v-text-field",{attrs:{label:"Price*",name:"price","prepend-icon":"mdi-currency-usd",rules:e.priceRules,outlined:"",color:"indigo"},model:{value:e.newCourse.price,callback:function(t){e.$set(e.newCourse,"price",t)},expression:"newCourse.price"}})],1),s("v-col",{attrs:{cols:"12",md:"4"}},[s("v-text-field",{attrs:{label:"Tagline",name:"tagline",outlined:"",color:"indigo"},model:{value:e.newCourse.tagline,callback:function(t){e.$set(e.newCourse,"tagline",t)},expression:"newCourse.tagline"}})],1)],1),s("v-row",[s("v-col",{attrs:{cols:"12"}},[s("v-textarea",{attrs:{label:"Description","auto-grow":"",outlined:"",color:"indigo"},model:{value:e.newCourse.description,callback:function(t){e.$set(e.newCourse,"description",t)},expression:"newCourse.description"}})],1)],1),s("v-row",[s("v-col",{attrs:{cols:"12",md:"4"}},[s("v-select",{attrs:{label:"Level",items:e.levels,outlined:"",color:"indigo"},model:{value:e.newCourse.level,callback:function(t){e.$set(e.newCourse,"level",t)},expression:"newCourse.level"}})],1),s("v-col",{attrs:{cols:"12",md:"4"}},[s("v-select",{attrs:{label:"Instrument",items:e.instruments,outlined:"",color:"indigo"},model:{value:e.newCourse.instrument,callback:function(t){e.$set(e.newCourse,"instrument",t)},expression:"newCourse.instrument"}})],1),s("v-col",{attrs:{cols:"12",md:"4"}},[s("v-select",{attrs:{label:"Language",items:e.languages,outlined:"",color:"indigo"},model:{value:e.newCourse.language,callback:function(t){e.$set(e.newCourse,"language",t)},expression:"newCourse.language"}})],1)],1),s("v-row",[s("v-col",{attrs:{cols:"12",md:"6"}},[s("v-file-input",{attrs:{accept:"video/mp4, video/ogg",placeholder:e.course.previewVideoUrl?e.course.previewVideoUrl.split("/")[6]:"Upload a preview video","prepend-icon":"mdi-video",label:"Preview Video",outlined:"",color:"indigo"},model:{value:e.newCourse.previewVideo,callback:function(t){e.$set(e.newCourse,"previewVideo",t)},expression:"newCourse.previewVideo"}})],1),s("v-col",{attrs:{cols:"12",md:"6"}},[s("v-file-input",{attrs:{accept:"image/*",placeholder:e.course.coverPhotoUrl?e.course.coverPhotoUrl.split("/")[6]:"Choose coverpage for your newCourse","prepend-icon":"mdi-image",label:"Cover Photo",outlined:"",color:"indigo"},model:{value:e.newCourse.coverPhoto,callback:function(t){e.$set(e.newCourse,"coverPhoto",t)},expression:"newCourse.coverPhoto"}})],1)],1),s("v-row",[s("v-col",{attrs:{cols:"12"}},[s("div",{staticStyle:{"font-size":"16px"}},[e._v("What will your students learn from the newCourse?")])]),e._l(e.newCourse.learningPoints,(function(t,r){return s("v-col",{key:r,staticClass:"py-1",attrs:{cols:"12"}},[s("v-text-field",{attrs:{color:"indigo",label:"Example: How to use pen tool in Photoshop",name:"tagline",outlined:"",dense:"","hide-details":"",rules:e.alphanumricRules},model:{value:e.newCourse.learningPoints[r],callback:function(t){e.$set(e.newCourse.learningPoints,r,t)},expression:"newCourse.learningPoints[idx]"}})],1)})),s("v-col",{attrs:{cols:"12"}},[s("v-btn",{attrs:{color:"indigo",text:""},on:{click:e.addLearningPoint}},[e._v("+ Add an answer")])],1)],2),s("v-row",[s("v-col",{attrs:{cols:"12"}},[s("div",{staticStyle:{"font-size":"16px"}},[e._v("Who are this newCourse for?")])]),e._l(e.newCourse.targetAudiences,(function(t,r){return s("v-col",{key:r,staticClass:"py-1",attrs:{cols:"12"}},[s("v-text-field",{attrs:{color:"indigo",label:"Example: Kids 6-8 years old",name:"tagline",outlined:"",dense:"","hide-details":"",rules:e.alphanumricRules},model:{value:e.newCourse.targetAudiences[r],callback:function(t){e.$set(e.newCourse.targetAudiences,r,t)},expression:"newCourse.targetAudiences[idx]"}})],1)})),s("v-col",{attrs:{cols:"12"}},[s("v-btn",{attrs:{color:"indigo",text:""},on:{click:e.addTargetAudience}},[e._v("+ Add an answer")])],1)],2),s("v-row",[s("v-col",{attrs:{cols:"12"}},[s("div",{staticStyle:{"font-size":"18px"}},[e._v("What are the requirements?")])]),e._l(e.newCourse.requirements,(function(t,r){return s("v-col",{key:r,staticClass:"py-1",attrs:{cols:"12"}},[s("v-text-field",{attrs:{color:"indigo",label:"Example: Photoshop software",name:"tagline",outlined:"",dense:"","hide-details":"",rules:e.alphanumricRules},model:{value:e.newCourse.requirements[r],callback:function(t){e.$set(e.newCourse.requirements,r,t)},expression:"newCourse.requirements[idx]"}})],1)})),s("v-col",{attrs:{cols:"12"}},[s("v-btn",{attrs:{color:"indigo",text:""},on:{click:e.addRequirement}},[e._v("+ Add an answer")])],1)],2)],1)],1)],1)],1)],1),s("v-row",{staticClass:"justify-center"},[s("v-col",{staticClass:"text-center"},[s("v-btn",{attrs:{color:"indigo",dark:"",loading:e.loading},on:{click:e.update}},[e._v("Save")]),s("v-btn",{attrs:{disabled:e.loading},on:{click:e.cancel}},[e._v("Cancel")])],1)],1)],1):e._e()},Fs=[],As=(s("a4d3"),s("e01a"),{name:"CourseForm",data:function(){return{course:null,newCourse:{name:"",tagline:"",price:"",description:"",language:"",level:"",instrument:"",targetAudiences:[""],learningPoints:[""],requirements:[""],coverPhoto:null,previewVideo:null},instruments:["Piano","Guitar","Drum Set","Er Hu","Yang Qin","French Horn","Violin","Body Percussion"],levels:["Beginner","Intermediate","Advanced"],languages:["English","Chinese"],nameRules:[function(e){return!!e||"Title is required"}],alphanumricRules:[function(e){return new RegExp("^[a-zA-Z0-9 !@#$%^*_(){}-]{0,100}$").test(e)||"You can only input alphanumeric characters"}],requiredRules:[function(e){return!!e||"This field is required"}],priceRules:[function(e){return!!e||"Price is required"},function(e){return new RegExp(/^\d+(?:\.\d{0,2})$/).test(e)||"Price must be a number with maximum 2 decimal places"}],error:null,loading:!1}},methods:{update:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$refs.courseForm.validate()){t.next=2;break}return t.abrupt("return");case 2:return e.loading=!0,e.error="",t.prev=4,s=new FormData,s.set("name",e.newCourse.name),s.set("tagline",e.newCourse.tagline),s.set("price",e.newCourse.price),s.set("description",e.newCourse.description),s.set("level",e.newCourse.level),s.set("instrument",e.newCourse.instrument),s.set("language",e.newCourse.language),s.set("targetAudiences",e.newCourse.targetAudiences.filter((function(e){return""!=e&&null!=e})).join("&")),s.set("learningPoints",e.newCourse.learningPoints.filter((function(e){return""!=e&&null!=e})).join("&")),s.set("requirements",e.newCourse.requirements.filter((function(e){return""!=e&&null!=e})).join("&")),s.set("id",e.course.id),e.newCourse.previewVideo&&s.append("previewVideo",e.newCourse.previewVideo),e.newCourse.coverPhoto&&s.append("coverPhoto",e.newCourse.coverPhoto),t.next=21,q.edit(s);case 21:e.$router.push("/course/edit/".concat(e.course.id)),t.next=27;break;case 24:t.prev=24,t.t0=t["catch"](4),e.error=t.t0.response.data.error;case 27:case"end":return t.stop()}}),t,null,[[4,24]])})))()},cancel:function(){this.$router.push("/course/edit/".concat(this.course.id))},addLearningPoint:function(){this.newCourse.learningPoints.push("")},addTargetAudience:function(){this.newCourse.targetAudiences.push("")},addRequirement:function(){this.newCourse.requirements.push("")}},mounted:function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,q.show(this.$route.params.course_id);case 2:this.course=e.sent.data.course,console.log(this.course),this.newCourse.name=this.course.name,null!=this.tagline&&(this.newCourse.tagline=this.course.tagline),null!=this.course.price&&(this.newCourse.price=this.course.price.toFixed(2)),null!=this.course.description&&(this.newCourse.description=this.course.description),this.newCourse.language=this.course.language,null!=this.course.level&&(this.newCourse.level=this.course.level),this.newCourse.instrument=this.course.instrument,null!=this.course.targetAudiences&&(this.newCourse.targetAudiences=this.course.targetAudiences?this.course.targetAudiences.split("&"):[]),null!=this.course.learningPoints&&(this.newCourse.learningPoints=this.course.learningPoints?this.course.learningPoints.split("&"):[]),null!=this.course.requirements&&(this.newCourse.requirements=this.course.requirements?this.course.requirements.split("&"):[]);case 14:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}),Ds=As,js=Object(h["a"])(Ds,Us,Fs,!1,null,null,null),$s=js.exports;m()(js,{VBtn:g["a"],VCard:Z["a"],VCardText:J["c"],VCardTitle:J["d"],VCol:Q["a"],VContainer:ee["a"],VDivider:te["a"],VFileInput:bt["a"],VForm:de["a"],VRow:re["a"],VSelect:We["a"],VTextField:me["a"],VTextarea:qt["a"]});var Hs=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-container",[e.$route.params.lesson_id&&e.lesson||e.$route.params.course_id?s("v-row",[s("v-col",[s("v-card",{staticClass:"text-left mb-12",attrs:{outlined:""}},[s("v-card-title",{staticClass:"display-1 px-10 font-weight-bold"},[e._v("Lesson"),s("v-spacer"),s("v-btn",{attrs:{outlined:"",color:"indigo",right:""},on:{click:e.deleteLesson}},[s("v-icon",{attrs:{color:"indigo"}},[e._v("mdi-trash-can-outline")])],1)],1),s("v-divider"),s("v-card-text",{staticClass:"px-10"},[s("v-form",{ref:"lessonForm"},[s("v-row",[s("v-col",{staticClass:"pb-0",attrs:{cols:"12",md:"4"}},[s("v-text-field",{attrs:{dense:"",label:"Name",name:"name",type:"text",rules:e.requiredRules,outlined:"",color:"indigo"},model:{value:e.newLesson.name,callback:function(t){e.$set(e.newLesson,"name",t)},expression:"newLesson.name"}},[e._v("Title*")])],1),s("v-col",{staticClass:"pb-0",attrs:{cols:"12",md:"4"}},[s("v-text-field",{attrs:{dense:"",label:"Duration in minutes",name:"duration",rules:e.durationRules,outlined:"",color:"indigo"},model:{value:e.newLesson.duration,callback:function(t){e.$set(e.newLesson,"duration",t)},expression:"newLesson.duration"}})],1)],1),s("v-row",[s("v-col",{staticClass:"pb-0",attrs:{cols:"12"}},[s("v-textarea",{attrs:{dense:"",label:"Description","auto-grow":"",color:"indigo",outlined:""},model:{value:e.newLesson.description,callback:function(t){e.$set(e.newLesson,"description",t)},expression:"newLesson.description"}})],1)],1)],1),s("v-row",[s("v-col",{attrs:{cols:"12"}},e._l(e.newLesson.exercises,(function(t,r){return s("div",{key:r,on:{click:function(e){}}},[s("div",{staticClass:"text-h5"},[e._v("Video Content"),s("v-form",{ref:"exerciseForm-"+r,refInFor:!0},[s("v-row",[s("v-col",{attrs:{cols:"12",md:"6"}},[s("v-file-input",{attrs:{accept:"video/mp4, video/ogg",placeholder:t.videoFilename?t.videoFilename:"Choose explanation video","prepend-icon":"mdi-video",label:"Explanation Video",outlined:"",color:"indigo",dense:"","hide-details":"",rules:e.requiredRules},model:{value:t.video,callback:function(s){e.$set(t,"video",s)},expression:"exercise.video"}})],1),s("v-col",{attrs:{cols:"12",md:"6"}},[s("v-file-input",{attrs:{accept:"image/*",placeholder:t.videoPosterFilename?t.videoPosterFilename:"Choose coverpage for video","prepend-icon":"mdi-image",label:"Explanation Video Poster",outlined:"",color:"indigo",dense:"","hide-details":""},model:{value:t.videoPoster,callback:function(s){e.$set(t,"videoPoster",s)},expression:"exercise.videoPoster"}})],1)],1),s("v-row",[s("v-col",{attrs:{cols:"12",md:"6"}},[s("v-switch",{staticClass:"ma-0",attrs:{label:"Overlay score on your video",color:"indigo",dense:"","hide-details":""},model:{value:t.useScore,callback:function(s){e.$set(t,"useScore",s)},expression:"exercise.useScore"}})],1)],1),s("v-row",[t.useScore?s("v-col",{staticClass:"py-0",attrs:{cols:"12",md:"6"}},[s("v-radio-group",{attrs:{mandatory:!0},on:{change:function(t){return e.showVex(t,r)}},model:{value:t.useXml,callback:function(s){e.$set(t,"useXml",s)},expression:"exercise.useXml"}},[s("v-radio",{attrs:{label:"Upload musicXML file",value:!0,color:"indigo"}}),s("v-radio",{attrs:{label:"Design your own score",value:!1,color:"indigo"}})],1)],1):e._e(),t.useScore?s("v-col",{staticClass:"py-0",attrs:{cols:"12",md:"6"}},[s("v-text-field",{attrs:{label:"Demo Start Time",color:"indigo","prepend-icon":"mdi-alarm","persistent-hint":"",hint:"At roughly which second did you start playing in demo video",rules:e.demoStartTimeRules},model:{value:t.demoStartTime,callback:function(s){e.$set(t,"demoStartTime",s)},expression:"exercise.demoStartTime"}})],1):e._e()],1),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.useXml&&t.useScore,expression:"!exercise.useXml && exercise.useScore"}]},[s("v-row",[s("v-col",{staticClass:"pa-0",attrs:{id:"pannel-content-"+r},on:{click:function(t){return e.changeMelody(t,r)}}})],1),s("v-row",[s("v-col",{staticClass:"pt-0",attrs:{cols:"12",md:"6"}},[s("div",{staticClass:"pl-0"},[e._v("No. Bars: "+e._s(t.numberOfBars))]),s("v-slider",{attrs:{min:"0",max:"16","thumb-label":"","thumb-size":24,color:"indigo","track-color":"indigo lighten-3","hide-details":""},on:{change:function(t){return e.changeBars(t,r)}},model:{value:t.numberOfBars,callback:function(s){e.$set(t,"numberOfBars",s)},expression:"exercise.numberOfBars"}})],1),s("v-col",{staticClass:"pt-0",attrs:{cols:"12",md:"6"}},[s("div",{staticClass:"pl-0"},[e._v("BPM for this score: "+e._s(t.bpm))]),s("v-slider",{attrs:{min:"60",max:"120","thumb-label":"","thumb-size":24,color:"indigo","track-color":"indigo lighten-3","hide-details":""},model:{value:t.bpm,callback:function(s){e.$set(t,"bpm",s)},expression:"exercise.bpm"}})],1),s("v-col",{attrs:{cols:"12",md:"6"}},[s("v-select",{attrs:{dense:"",items:e.time_signatures,outlined:"",label:"Time Signature",color:"indigo"},on:{change:function(t){return e.changeTimeSignature(t,r)}},model:{value:t.timeSignature,callback:function(s){e.$set(t,"timeSignature",s)},expression:"exercise.timeSignature"}})],1)],1)],1),s("div",{directives:[{name:"show",rawName:"v-show",value:t.useXml&&t.useScore,expression:"exercise.useXml && exercise.useScore"}]},[s("v-row",[s("v-col",{attrs:{cols:"12",md:"6"}},[s("v-file-input",{attrs:{accept:"text/xml, .musicxml",placeholder:t.musicXmlFilname?t.musicXmlFilename:"Music XML file","prepend-icon":"mdi-file-document-outline",label:"Upload musicxml file",outlined:"",dense:""},model:{value:t.musicXml,callback:function(s){e.$set(t,"musicXml",s)},expression:"exercise.musicXml"}})],1),s("v-col",{staticClass:"pt-0",attrs:{cols:"12",md:"6"}},[s("div",{staticClass:"pl-0"},[e._v("BPM for this score: "+e._s(t.bpm))]),s("v-slider",{attrs:{min:"60",max:"120","thumb-label":"","thumb-size":24,color:"indigo","track-color":"indigo lighten-3","hide-details":""},model:{value:t.bpm,callback:function(s){e.$set(t,"bpm",s)},expression:"exercise.bpm"}})],1)],1)],1)],1)],1)])})),0)],1)],1)],1)],1)],1):e._e(),s("v-row",{staticClass:"justify-center"},[s("v-col",{staticClass:"text-center"},[s("v-btn",{attrs:{color:"indigo",loading:e.loading,dark:""},on:{click:e.update}},[e._v("Save")]),s("v-btn",{attrs:{disabled:e.loading},on:{click:e.cancel}},[e._v("Cancel")])],1)],1)],1)},Ws=[],qs=(s("a9e3"),s("c4e3")),Xs=s.n(qs),Ks=s("21a6"),zs={name:"LessonForm",data:function(){return{newLesson:{name:"",duration:"",description:"",files:[],exercises:[{name:"",video:null,videoFilename:"",videoPoster:null,videoPosterFilename:"",useScore:!0,timeSignature:"4/4",bpm:60,numberOfBars:4,melody:[],demoStartTime:"0",useXml:!0,musicXml:null,musicXmlFilename:"",handler:null}]},lesson:null,requiredRules:[function(e){return!!e||"This field is required"}],durationRules:[function(e){return!!e||"Duration is required"},function(e){return new RegExp(/^\d+$/).test(e)||"Please input numbers only"}],demoStartTimeRules:[function(e){return!!e||"Demo Start Time is required"},function(e){return new RegExp(/^\d+$/).test(e)||"Please input numbers only"}],nameRules:[function(e){return!!e||"Name is required"},function(e){return new RegExp(/^[a-zA-Z0-9 ]{2,30}$/).test(e)||"Name must be alphanumeric characters and of length 2 - 30"}],fileRules:[function(e){for(var t=0;t<e.length;t++)if(e[t].size>0x773594ccd56a0)return"File cannot be larger than 2GB";return!0}],time_signatures:["4/4","3/4","2/4","3/8","6/8"],loading:!1,error:null,fileDialog:!1,newFiles:[],options:["Download","Delete"],uuid:0,openedExercise:[0]}},methods:{showFile:function(){this.fileDialog=!0},showVex:function(e,t){var s=this;return Object(F["a"])(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!=s.newLesson.exercises[t].handler||s.newLesson.exercises[t].useXml||!s.newLesson.exercises[t].useScore){e.next=8;break}return e.next=3,s.$nextTick();case 3:r=document.createElement("div"),r.id="vexflow-wrapper-".concat(t),n=document.getElementById("pannel-content-".concat(t)),n.appendChild(r),s.newLesson.exercises[t].handler=new et["a"].Handler(r.id,{canvasProperties:{id:r.id+"-canvas",width:n.offsetWidth,tabindex:1}}).init();case 8:console.log(s.newLesson.exercises[t].handler);case 9:case"end":return e.stop()}}),e)})))()},changeTimeSignature:function(e,t){this.newLesson.exercises[t].handler.setTimeSignature(this.newLesson.exercises[t].timeSignature)},changeBars:function(e,t){console.log(t),this.newLesson.exercises[t].handler.changeNumberOfBars(this.newLesson.exercises[t].numberOfBars,this.newLesson.exercises[t].handler.exportNotes())},changeMelody:function(e,t){this.newLesson.exercises[t].melody=this.newLesson.exercises[t].handler.exportNotes()},update:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){var s,r,n,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s=e.newLesson,e.$refs.lessonForm.validate()){t.next=3;break}return t.abrupt("return");case 3:r=0;case 4:if(!(r<s.exercises.length)){t.next=14;break}if(!s.exercises[r].useScore||s.exercises[r].musicXml||0!=s.exercises[r].melody.length){t.next=8;break}return alert("Please ensure that you have input corresponding data if you choose to use score"),t.abrupt("return");case 8:if(s.exercises[r].video||""!=s.exercises[r].videoFilename){t.next=11;break}return alert("Please ensure that you have input a video for video content"),t.abrupt("return");case 11:r++,t.next=4;break;case 14:if(e.loading=!0,n=null,!e.$route.params.lesson_id){t.next=21;break}return t.next=19,Le.edit({id:e.lesson.id,name:e.newLesson.name,duration:Number(e.newLesson.duration),description:e.newLesson.description});case 19:t.next=26;break;case 21:return t.next=23,Le.create({name:e.newLesson.name,duration:Number(e.newLesson.duration),description:e.newLesson.description,cid:e.$route.params.course_id});case 23:return n=t.sent,t.next=26,Promise.all(e.newLesson.files.map(function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(t){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=new FormData,s.set("lessonId",n.data.lesson.id),s.set("name",t.name),s.set("size",parseInt(t.size)),s.set("type",t.type),s.append("file",t.file),e.abrupt("return",xs.create(s));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 26:i=0;case 27:if(!(i<s.exercises.length)){t.next=58;break}if(o=new FormData,o.set("name",s.exercises[i].name),o.set("melody",s.exercises[i].melody.join("-")),o.set("timeSignature",s.exercises[i].timeSignature),o.set("bpm",s.exercises[i].bpm),o.set("numberOfBars",s.exercises[i].numberOfBars),o.set("demoStartTime",parseInt(s.exercises[i].demoStartTime)),o.set("useScore",s.exercises[i].useScore),s.exercises[i].useScore&&(s.exercises[i].useXml?o.set("useXml",!0):(o.set("useXml",!1),o.set("melody",s.exercises[i].melody.join("-")),o.set("timeSignature",s.exercises[i].timeSignature))),s.exercises[i].video&&o.append("video",s.exercises[i].video),s.exercises[i].videoPoster&&o.append("videoPoster",s.exercises[i].videoPoster),s.exercises[i].musicXml&&o.append("musicXml",s.exercises[i].musicXml),!s.exercises[i].id){t.next=46;break}return o.set("id",s.exercises[i].id),t.next=44,Qe.edit(o);case 44:t.next=55;break;case 46:if(!e.lesson){t.next=52;break}return o.set("lid",e.lesson.id),t.next=50,Qe.create(o);case 50:t.next=55;break;case 52:return o.set("lid",n.data.lesson.id),t.next=55,Qe.create(o);case 55:i++,t.next=27;break;case 58:e.loading=!1,e.cancel();case 60:case"end":return t.stop()}}),t)})))()},cancel:function(){this.$route.params.lesson_id?this.$router.push("/course/edit/".concat(this.lesson.CourseId)):this.$router.push("/course/edit/".concat(this.$route.params.course_id))},deleteLesson:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Le.delete(e.lesson.id);case 2:e.$router.push("/course/edit/".concat(e.lesson.CourseId));case 3:case"end":return t.stop()}}),t)})))()},newFile:function(){var e=this;return Object(F["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.fileForm.validate()&&(e.loading=!0,e.lesson?e.newFiles.forEach(function(){var t=Object(F["a"])(regeneratorRuntime.mark((function t(s){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=new FormData,r.set("lessonId",e.lesson.id),r.set("name",s.name),r.set("size",parseInt(s.size/1024)),r.set("type",s.type),r.append("file",s),t.t0=e.newLesson.files,t.next=9,xs.create(r);case 9:t.t1=t.sent.data.file,t.t0.push.call(t.t0,t.t1);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()):e.newLesson.files=e.newLesson.files.concat(e.newFiles.map((function(e){return{file:e,size:e.size/1024,type:e.type,name:e.name}}))),e.newFiles=[],e.fileDialog=!1,e.loading=!1);case 1:case"end":return t.stop()}}),t)})))()},fileCrud:function(e,t,s){var r=this;return Object(F["a"])(regeneratorRuntime.mark((function e(){var n,i,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("Download"!=s){e.next=5;break}new Xs.a,fetch(t.url).then((function(e){return e.blob()})).then((function(e){return Object(Ks["saveAs"])(e,t.name)})),e.next=13;break;case 5:if("Delete"!=s){e.next=12;break}return n=r.newLesson.files.indexOf(t),r.newLesson.files.splice(n,1),e.next=10,xs.delete(t.id);case 10:e.next=13;break;case 12:"Download All"==s&&r.newLesson.files.length>0&&(i=new Xs.a,o=r.newLesson.files,Promise.all(o.map((function(e){return fetch(e.url)}))).then((function(e){return Promise.all(e.map((function(e){return e.blob()})))})).then((function(e){for(var t=0;t<e.length;t++)i.file(o[t].name,e[t]);i.generateAsync({type:"blob"}).then((function(e){Object(Ks["saveAs"])(e,"download.zip")}))})).catch((function(e){console.log(e)})));case 13:case"end":return e.stop()}}),e)})))()},newExercise:function(){this.newLesson.exercises.push({name:"",video:null,videoFilename:"",videoPoster:null,videoPosterFilename:"",useScore:!0,timeSignature:"4/4",bpm:60,numberOfBars:4,melody:[],demoStartTime:"",useXml:!0,musicXml:null,musicXmlFilename:"",handler:null})},deleteExercise:function(e,t){this.newLesson.exercises.splice(t,1)}},mounted:function(){var e=Object(F["a"])(regeneratorRuntime.mark((function e(){var t,s,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.$route.params.lesson_id){e.next=41;break}return e.next=3,Le.show(this.$route.params.lesson_id);case 3:return this.lesson=e.sent.data.lesson,e.next=6,xs.list(this.lesson.id);case 6:if(this.newLesson.files=e.sent.data.files,this.newLesson.name=this.lesson.name,this.newLesson.duration=this.lesson.duration,this.newLesson.description=this.lesson.description,!(this.lesson.Exercises.length>0)){e.next=41;break}t=0;case 12:if(!(t<this.lesson.Exercises.length)){e.next=41;break}if(this.newLesson.exercises[t]||this.newExercise(),this.newLesson.exercises[t].id=this.lesson.Exercises[t].id,this.newLesson.exercises[t].name=this.lesson.Exercises[t].name,this.newLesson.exercises[t].useScore=this.lesson.Exercises[t].useScore,this.newLesson.exercises[t].useXml=this.lesson.Exercises[t].useXml,this.newLesson.exercises[t].videoFilename=this.lesson.Exercises[t].videoFilename,this.newLesson.exercises[t].videoPosterFilename=this.lesson.Exercises[t].videoPosterFilename,!this.newLesson.exercises[t].useScore){e.next=38;break}if(this.newLesson.exercises[t].bpm=this.lesson.Exercises[t].bpm,this.newLesson.exercises[t].demoStartTime=this.lesson.Exercises[t].demoStartTime.toString(),this.newLesson.exercises[t].useXml||0!=t){e.next=37;break}return this.newLesson.exercises[t].timeSignature=this.lesson.Exercises[t].timeSignature,this.newLesson.exercises[t].numberOfBars=this.lesson.Exercises[t].numberOfBars,this.newLesson.exercises[t].melody=this.lesson.Exercises[t].melody.split("-"),e.next=29,this.$nextTick();case 29:s=document.createElement("div"),s.id="vexflow-wrapper-".concat(t),r=document.getElementById("pannel-content-".concat(t)),r.appendChild(s),this.newLesson.exercises[t].handler=new et["a"].Handler(s.id,{numberOfStaves:this.newLesson.exercises[t].numberOfBars,canvasProperties:{id:s.id+"-canvas",width:r.offsetWidth,tabindex:1}}).init(),""!=this.newLesson.exercises[t].melody&&this.newLesson.exercises[t].handler.importNotes(this.newLesson.exercises[t].melody,this.newLesson.exercises[t].timeSignature),e.next=38;break;case 37:this.newLesson.exercises[t].musicXmlFilename=this.lesson.Exercises[t].musicXmlFilename;case 38:t++,e.next=12;break;case 41:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},Ys=zs,Gs=(s("e427"),s("b73d")),Zs=Object(h["a"])(Ys,Hs,Ws,!1,null,"361004ad",null),Js=Zs.exports;m()(Zs,{VBtn:g["a"],VCard:Z["a"],VCardText:J["c"],VCardTitle:J["d"],VCol:Q["a"],VContainer:ee["a"],VDivider:te["a"],VFileInput:bt["a"],VForm:de["a"],VIcon:b["a"],VRadio:he["a"],VRadioGroup:pe["a"],VRow:re["a"],VSelect:We["a"],VSlider:Cs["a"],VSpacer:S["a"],VSwitch:Gs["a"],VTextField:me["a"],VTextarea:qt["a"]});var Qs=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("video",{ref:"videoPlayer",staticClass:"vjs-big-play-centered vjs-16-9 video-js",attrs:{id:"video"}})])},er=[],tr=(s("090c"),s("7d87"),{name:"MpegDash",data:function(){return{player:null}},watch:{},methods:{},mounted:function(){this.player=Object(bs["default"])(this.$refs.videoPlayer,{controls:!0,fluid:!0,sources:[{src:"https://rhythm-academy.s3.ap-southeast-1.amazonaws.com/wangrunding%40gmail.com/Stand+up+for+Singapore/introduction/mpeg_dash_videos/vertical_1080_test-manifest-full.mpd",type:"application/dash+xml"}],playbackRates:[.8,.9,1,1.1,1.2]})}}),sr=tr,rr=Object(h["a"])(sr,Qs,er,!1,null,"e0b39e0a",null),nr=rr.exports,ir=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Plotly",{attrs:{data:e.data,layout:e.layout,"display-mode-bar":!1,"static-plot":!0,responsive:!0}}),e._l(e.graphs,(function(e){return s("Plotly",{attrs:{data:e.data,layout:e.layout,"display-mode-bar":!1,"static-plot":!0,responsive:!0}})}))],2)},or=[],ar={name:"AutoEvaluation",components:{Plotly:ps["Plotly"]},methods:{getSecondsPerRow:function(){var e=4,t=60,s=4;return 60/t*e*s},getNumberFromMusicNote:function(e){var t=e[1]-"0",s=e[0].charCodeAt(0)-"C".charCodeAt(0);return s<0&&(s+=8),8*t+s},getLineSegmentForMusicNote:function(e){var t=this.getLineSegmentYValForMusicNote(e);return{type:"line",x0:e.onset,y0:t,x1:e.onset+e.duration,y1:t,line:{color:"rgb(55, 128, 191)",width:3}}},getLineSegmentYValForMusicNote:function(e){var t=this.getNumberFromMusicNote(this.minNoteNumber),s=this.getNumberFromMusicNote(this.maxNoteNumber),r=this.getNumberFromMusicNote(e.noteNumber);return(r-t)/(s-t)*(this.maxNoteNumber[1]-this.minNoteNumber[1])},splitIntoRows:function(e){var t=this.getSecondsPerRow(),s=0,r=[];r.push([]);for(var n=0;n<e.length;n++){var i=e[n];if(i.onset<s+t)if(i.onset+i.duration<=s+t)r[r.length-1].push(i);else{var o=Object(c["a"])({},i);o.onset=s+t,o.duration=i.onset+i.duration-(s+t),i.duration=i.duration-o.duration,r[r.length-1].push(i),e[n]=o,s+=t,r.push([]),n--}else s+=t,r.push([]),n--}return r},getTickValsForRow:function(e){for(var t=this,s=[],r=0;r<=this.barsPerRow*this.timeSignature;r++)s.push(r);return s.map((function(s){return s+e*t.barsPerRow*t.timeSignature}))},getAnnotationXValsForNotes:function(e){return e.map((function(e){return e.onset+e.duration/2}))},getAnnotationYValsForNotes:function(e){var t=this;return e.map((function(e){var s=t.getLineSegmentYValForMusicNote(e)+.3;return s<=t.maxNoteNumber[1]-t.minNoteNumber[1]?s:s-.7}))},getAnnotationsForNotes:function(e){return e.map((function(e){return e.noteNumber}))},getBarDividers:function(e){for(var t=0,s=this.maxNoteNumber[1]-this.minNoteNumber[1],r=[],n=1;n<=this.barsPerRow;n++){var i=n*this.timeSignature+e*this.timeSignature*this.barsPerRow,o={type:"line",x0:i,y0:t,x1:i,y1:s,line:{color:"#bdbdbd",width:2}};r.push(o)}return r},getGraphsForNotes:function(e){for(var t=this,s=this.splitIntoRows(e),r=[],n=0;n<s.length;n++){var i=s[n],o={data:[{x:this.getAnnotationXValsForNotes(i),y:this.getAnnotationYValsForNotes(i),text:this.getAnnotationsForNotes(i),mode:"text"}],layout:{xaxis:{zeroline:!1,range:[n*this.secondsPerRow,(n+1)*this.secondsPerRow+.1],tickvals:this.getTickValsForRow(n),tickfont:{family:"Old Standard TT, serif",size:10,color:"Brown"}},yaxis:{range:[0,3.1],tickvals:[0,1,2,3],ticktext:["C3","C4","C5","C6"],tickfont:{family:"Old Standard TT, serif",size:10,color:"Brown"}},width:1200,height:250,shapes:i.map((function(e){return t.getLineSegmentForMusicNote(e)})).concat(this.getBarDividers(n))}};r.push(o)}return r}},data:function(){return{minNoteNumber:"C3",maxNoteNumber:"C6",bpm:60,timeSignature:4,barsPerRow:4,secondsPerRow:this.getSecondsPerRow(),transcribedNotes:[{onset:.3,noteNumber:"C6",duration:5},{onset:5.3,noteNumber:"A3",duration:4},{onset:10,noteNumber:"D3",duration:8},{onset:18,noteNumber:"E3",duration:5},{onset:23,noteNumber:"F3",duration:4},{onset:28,noteNumber:"G3",duration:5},{onset:33,noteNumber:"A3",duration:3}],graphs:[],data:[{x:[.75,1.8],y:[.2,.6],text:["A1","A2"],mode:"text"}],layout:{title:"My graph",xaxis:{range:[0,4]},yaxis:{range:[0,3],tickvals:[0,1,2,3],ticktext:["C3","C4","C5","C6"]},width:400,height:250,shapes:[{type:"line",x0:.5,y0:.5,x1:1,y1:.5,line:{color:"rgb(55, 128, 191)",width:3}},{type:"line",x0:1.5,y0:1,x1:2.2,y1:1,line:{color:"rgb(127, 255, 212)",width:3}},{type:"line",x0:2.2,y0:1.5,x1:3,y1:1.5,line:{color:"rgb(255, 127, 80)",width:3},name:"A4"},{type:"line",x0:3,y0:1,x1:3.3,y1:1,line:{color:"rgb(255, 215, 0)",width:3}}]}}},created:function(){this.graphs=this.getGraphsForNotes(this.transcribedNotes)}},cr=ar,lr=Object(h["a"])(cr,ir,or,!1,null,"178a1948",null),ur=lr.exports;r["a"].use(L["a"]);var dr=[{path:"/",name:"home",component:ie},{path:"/register",name:"register",component:fe},{path:"/login",name:"login",component:ye},{path:"/auto-evaluation",name:"autoevaluation",component:ur},{path:"/course/show/:course_id",name:"showcourse",component:Ee,props:!0},{path:"/course/edit/:course_id",name:"editcourse",component:nt},{path:"/course/form/:course_id",name:"courseform",component:$s},{path:"/lesson/edit-form/:lesson_id",component:Js},{path:"/lesson/new-form/:course_id",component:Js},{path:"/course/show/:course_id/lesson/:lesson_id",name:"showlesson",component:Ms,props:!0},{path:"/course/index",name:"courseindex",component:Ae},{path:"/course/new/",name:"newcourse",component:Ge},{path:"/user/index/NiIsInR5cCI6IkpXVCJ9",name:"userindex",beforeEnter:function(e,t,s){"wangrunding@gmail.com"!=H.state.user.email?s({path:t.fullPath}):s()},component:dt},{path:"/video",name:"video",component:_t},{path:"/courses/threads/index",component:Tt},{path:"/course/threads/index/:course_id",component:Ot},{path:"/course/threads/show/:course_id/:student_id",name:"showthread",component:Kt,props:!0},{path:"/payment/:course_id",name:"payment",component:es},{path:"/osmd",component:as},{path:"/mpeg-dash",component:nr}],hr=new L["a"]({mode:"history",routes:dr});hr.beforeEach((function(e,t,s){"showcourse"==e.name||"login"==e.name||H.state.isUserLoggedIn||"home"==e.name||"register"==e.name?s():s({name:"login"})}));var pr=hr,mr=s("f309"),vr=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("svg",{attrs:{id:"svg2",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 57.2 99.95"}},[s("title",[e._v("bg")]),s("g",{attrs:{id:"path3821"}},[s("rect",{attrs:{x:"34.97",y:"79.23",width:"22.23",height:"4"}}),s("rect",{attrs:{x:"34.97",y:"88.71",width:"22.23",height:"4"}}),s("path",{attrs:{d:"M25.4,0h4v83.1h-.07c.41,5.12-3.7,11.2-10.33,14.6-7.7,3.9-16,2.6-18.4-2.9s1.9-13.2,9.7-17.2c5.44-2.8,11.31-3,15.1-.73Z",transform:"translate(0.06 -0.04)"}})])])},fr=[],gr={name:"bpmIcon"},br=gr,xr=(s("036d"),Object(h["a"])(br,vr,fr,!1,null,"5ad94150",null)),wr=xr.exports;r["a"].use(mr["a"]);var _r=new mr["a"]({icons:{values:{custom_bpm:{component:wr}}}}),yr=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"panel"}},[s("v-row",{attrs:{align:"center",justify:"center"}},[s("v-col",{attrs:{cols:"12",sm:"10",md:e.md||6}},[s("v-card",{staticClass:"elevation-8"},[s("v-toolbar",{attrs:{light:""}},[s("v-toolbar-title",{staticClass:"text-h4"},[e._v(e._s(e.title))]),s("v-spacer")],1),e._t("default",[e._v("No slot defined")])],2)],1)],1)],1)},kr=[],Cr={name:"Panel",props:["title","md"]},Sr=Cr,Vr=Object(h["a"])(Sr,yr,kr,!1,null,"467599f2",null),Tr=Vr.exports;m()(Vr,{VCard:Z["a"],VCol:Q["a"],VRow:re["a"],VSpacer:S["a"],VToolbar:Pe["a"],VToolbarTitle:V["b"]}),r["a"].config.productionTip=!1,r["a"].component("panel",Tr),new r["a"]({router:pr,store:H,vuetify:_r,render:function(e){return e(B)}}).$mount("#app")},5718:function(e,t,s){},"6a72":function(e,t,s){"use strict";var r=s("6ccb"),n=s.n(r);n.a},"6b7d":function(e,t,s){"use strict";var r=s("88c4"),n=s.n(r);n.a},"6ccb":function(e,t,s){},7812:function(e,t,s){},"85ec":function(e,t,s){},"88c4":function(e,t,s){},"9e85":function(e,t,s){"use strict";var r=s("287e"),n=s.n(r);n.a},ad98:function(e,t,s){"use strict";var r=s("4cf2"),n=s.n(r);n.a},b020:function(e,t,s){e.exports=s.p+"img/play_button.3f8fd321.png"},d0d9:function(e,t,s){},d2e0:function(e,t,s){},d449:function(e,t,s){"use strict";var r=s("dafe"),n=s.n(r);n.a},da33:function(e,t,s){"use strict";var r=s("4799"),n=s.n(r);n.a},dafe:function(e,t,s){},de6d:function(e,t,s){},e427:function(e,t,s){"use strict";var r=s("2e05"),n=s.n(r);n.a}});
//# sourceMappingURL=app.4ddd535d.js.map